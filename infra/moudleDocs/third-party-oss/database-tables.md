# 阿里云OSS服务 - 数据库表说明

## 数据库脚本位置
`infra/database/data/third-party/third-party-oss-schema.sql`

## 表结构说明

### 1. oss_file_info (文件信息表)
**业务功能**: 存储文件元数据和访问信息，支持文件的基本管理功能
- 文件基本信息：名称、大小、类型、MIME类型
- 存储信息：OSS存储桶、对象键、文件路径
- 访问控制：权限设置、过期时间
- 统计信息：下载次数、查看次数
- 用户信息：上传用户ID、用户名

### 2. oss_file_category (文件分类表)
**业务功能**: 支持文件分类管理，树形结构，便于文件组织和查找
- 分类信息：名称、编码、描述、图标
- 层级结构：父分类ID、分类层级
- 排序管理：排序顺序
- 状态管理：启用/禁用状态

### 3. oss_file_access_log (文件访问日志表)
**业务功能**: 记录文件访问情况，支持审计和统计，提供访问数据分析
- 访问信息：访问类型、用户信息、IP地址
- 技术信息：用户代理、来源页面、响应时间
- 状态信息：HTTP状态码、错误信息
- 时间信息：访问时间

### 4. oss_file_process_task (文件处理任务表)
**业务功能**: 记录异步文件处理任务，支持图片压缩、水印、格式转换等处理
- 任务信息：任务类型、处理参数
- 状态管理：任务状态、重试次数
- 结果信息：结果文件ID、错误信息
- 时间信息：创建时间、更新时间

### 5. oss_file_share (文件分享表)
**业务功能**: 支持文件分享功能，提供公开、私有、密码分享等多种分享方式
- 分享信息：分享码、分享类型、分享密码
- 用户信息：分享用户ID、用户名
- 访问统计：访问次数、下载次数
- 时间管理：过期时间、创建时间

## 初始化数据

### 文件分类初始化
系统预置了以下文件分类：
- **一级分类**: 图片文件、文档文件、视频文件、音频文件、其他文件
- **二级分类**: 
  - 图片文件下：头像图片、产品图片、广告图片
  - 文档文件下：PDF文档、Word文档、Excel表格

## 索引设计

### 性能优化索引
- 文件名索引：支持文件名模糊查询
- 文件类型索引：支持按类型筛选
- 用户索引：支持按上传用户查询
- 时间索引：支持时间范围查询
- MD5索引：支持文件去重

### 业务索引
- 分类索引：支持分类层级查询
- 状态索引：支持状态筛选
- 分享码索引：支持分享链接访问

## 数据维护

### 定期清理
- 删除的文件记录（逻辑删除）
- 过期的访问日志
- 失败的处理任务
- 过期的分享链接

### 数据备份
- 文件元数据定期备份
- 访问日志归档
- 分类数据备份 