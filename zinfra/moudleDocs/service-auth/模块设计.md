# è®¤è¯æœåŠ¡æ¨¡å—è®¾è®¡æ–‡æ¡£

## ğŸ“‹ æ¨¡å—æ¦‚è¿°

### åŸºæœ¬ä¿¡æ¯
- **æ¨¡å—åç§°**: service-auth
- **æ¨¡å—ç±»å‹**: å¾®æœåŠ¡æ¨¡å—
- **ä¸»è¦èŒè´£**: ç”¨æˆ·è®¤è¯ã€JWTä»¤ç‰Œç®¡ç†ã€æƒé™éªŒè¯
- **æŠ€æœ¯æ ˆ**: Spring Boot + Spring Security + JWT + Redis
- **ä½œè€…**: scccy
- **åˆ›å»ºæ—¶é—´**: 2025-01-27

### è®¾è®¡ç†å¿µ
åŸºäºç®€åŒ–çš„æƒé™æ§åˆ¶æ¶æ„ï¼Œä½¿ç”¨ç”¨æˆ·ç±»å‹å­—æ®µç›´æ¥æ§åˆ¶æƒé™ï¼Œæ‘’å¼ƒå¤æ‚çš„RBACç³»ç»Ÿï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒæ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Controller    â”‚    â”‚     Service     â”‚    â”‚     Mapper      â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚  AuthController â”‚â”€â”€â”€â–¶â”‚   AuthService   â”‚â”€â”€â”€â–¶â”‚  SysUserMapper  â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Interceptor   â”‚    â”‚      Util       â”‚    â”‚    Database     â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ JwtInterceptor  â”‚    â”‚  JwtUtil        â”‚    â”‚    sys_user     â”‚
â”‚                 â”‚    â”‚  JwtTokenManagerâ”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æƒé™æ§åˆ¶æ¨¡å‹
```
ç”¨æˆ·ç±»å‹ (user_type)
â”œâ”€â”€ 1: ç³»ç»Ÿç®¡ç†å‘˜ (æ‹¥æœ‰æ‰€æœ‰æƒé™)
â”œâ”€â”€ 2: å‘å¸ƒè€… (å¯ä»¥å‘å¸ƒä»»åŠ¡)
â””â”€â”€ 3: æ¥å—è€… (å¯ä»¥æ¥å—ä»»åŠ¡)
```

## ğŸ“ ç›®å½•ç»“æ„

```
service-auth/
â”œâ”€â”€ src/main/java/com/origin/auth/
â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â””â”€â”€ AuthController.java              # è®¤è¯æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â”œâ”€â”€ AuthService.java                 # è®¤è¯æœåŠ¡æ¥å£
â”‚   â”‚   â”œâ”€â”€ SysUserService.java              # ç”¨æˆ·æœåŠ¡æ¥å£
â”‚   â”‚   â””â”€â”€ impl/
â”‚   â”‚       â”œâ”€â”€ AuthServiceImpl.java         # è®¤è¯æœåŠ¡å®ç°
â”‚   â”‚       â””â”€â”€ SysUserServiceImpl.java      # ç”¨æˆ·æœåŠ¡å®ç°
â”‚   â”œâ”€â”€ entity/
â”‚   â”‚   â””â”€â”€ SysUser.java                     # ç”¨æˆ·å®ä½“
â”‚   â”œâ”€â”€ mapper/
â”‚   â”‚   â””â”€â”€ SysUserMapper.java               # ç”¨æˆ·æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”œâ”€â”€ LoginRequest.java                # ç™»å½•è¯·æ±‚DTO
â”‚   â”‚   â”œâ”€â”€ LoginResponse.java               # ç™»å½•å“åº”DTO
â”‚   â”‚   â””â”€â”€ UserInfoResponse.java            # ç”¨æˆ·ä¿¡æ¯å“åº”DTO
â”‚   â”œâ”€â”€ util/
â”‚   â”‚   â”œâ”€â”€ JwtUtil.java                     # JWTå·¥å…·ç±»
â”‚   â”‚   â””â”€â”€ JwtTokenManager.java             # JWTä»¤ç‰Œç®¡ç†å™¨
â”‚   â”œâ”€â”€ interceptor/
â”‚   â”‚   â””â”€â”€ JwtInterceptor.java              # JWTæ‹¦æˆªå™¨
â”‚   â”œâ”€â”€ exception/
â”‚   â”‚   â””â”€â”€ AuthException.java               # è®¤è¯å¼‚å¸¸
â”‚   â””â”€â”€ ServiceAuthApplication.java          # å¯åŠ¨ç±»
â””â”€â”€ src/main/resources/
    â”œâ”€â”€ application.yml                      # é…ç½®æ–‡ä»¶
    â””â”€â”€ mapper/
        â””â”€â”€ SysUserMapper.xml                # MyBatisæ˜ å°„æ–‡ä»¶
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶

### 1. è®¤è¯æ§åˆ¶å™¨ (AuthController)

#### ä¸»è¦æ¥å£
```java
@RestController
@RequestMapping("/service/auth")
public class AuthController {
    
    // ç”¨æˆ·ç™»å½•
    @PostMapping("/login")
    public ResultData<LoginResponse> login(@RequestBody LoginRequest request);
    
    // ç”¨æˆ·ç™»å‡º
    @PostMapping("/logout")
    public ResultData<String> logout(HttpServletRequest request);
    
    // å¥åº·æ£€æŸ¥
    @GetMapping("/test")
    public ResultData<String> test(HttpServletRequest request);
    
    // å¼ºåˆ¶ç™»å‡ºç”¨æˆ·ï¼ˆç®¡ç†å‘˜åŠŸèƒ½ï¼‰
    @PostMapping("/logout/force/{userId}")
    public ResultData<String> forceLogout(@PathVariable String userId);
}
```

#### æ¥å£è¯´æ˜
| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|------|
| ç”¨æˆ·ç™»å½• | POST | `/service/auth/login` | å¤„ç†ç”¨æˆ·ç™»å½•ï¼Œè¿”å›JWTä»¤ç‰Œ |
| ç”¨æˆ·ç™»å‡º | POST | `/service/auth/logout` | å¤„ç†ç”¨æˆ·ç™»å‡ºï¼Œæ¸…é™¤ä»¤ç‰Œ |
| å¥åº·æ£€æŸ¥ | GET | `/service/auth/test` | æœåŠ¡å¥åº·æ£€æŸ¥ |
| å¼ºåˆ¶ç™»å‡º | POST | `/service/auth/logout/force/{userId}` | ç®¡ç†å‘˜å¼ºåˆ¶ç™»å‡ºç”¨æˆ· |

### 2. è®¤è¯æœåŠ¡ (AuthService)

#### æ ¸å¿ƒæ–¹æ³•
```java
public interface AuthService {
    
    // ç”¨æˆ·ç™»å½•
    LoginResponse login(LoginRequest request);
    
    // éªŒè¯JWTä»¤ç‰Œ
    boolean validateToken(String token);
    
    // ç”¨æˆ·ç™»å‡º
    void logout(String token);
    
    // å¼ºåˆ¶ç™»å‡ºç”¨æˆ·
    void forceLogout(String userId);
    
    // ä»ä»¤ç‰Œè·å–ç”¨æˆ·ä¿¡æ¯
    String getUsernameFromToken(String token);
    String getUserIdFromToken(String token);
    Integer getUserTypeFromToken(String token);
    
    // æƒé™éªŒè¯
    boolean hasPermission(String userId, Integer requiredUserType);
    boolean isAdmin(String userId);
    boolean isPublisher(String userId);
    boolean isReceiver(String userId);
    
    // è·å–ç”¨æˆ·ä¿¡æ¯
    UserInfoResponse getUserInfo(String userId);
}
```

#### æƒé™éªŒè¯é€»è¾‘
```java
// æƒé™éªŒè¯ç¤ºä¾‹
public boolean hasPermission(String userId, Integer requiredUserType) {
    SysUser user = sysUserService.getById(userId);
    if (user == null || !sysUserService.isUserStatusNormal(user)) {
        return false;
    }
    
    // ç®¡ç†å‘˜æ‹¥æœ‰æ‰€æœ‰æƒé™
    if (user.getUserType() == 1) {
        return true;
    }
    
    // æ£€æŸ¥ç”¨æˆ·ç±»å‹æ˜¯å¦åŒ¹é…
    return user.getUserType().equals(requiredUserType);
}
```

### 3. ç”¨æˆ·æœåŠ¡ (SysUserService)

#### æ ¸å¿ƒæ–¹æ³•
```java
public interface SysUserService extends IService<SysUser> {
    
    // ç”¨æˆ·æŸ¥è¯¢
    SysUser getByUsername(String username);
    SysUser getByPhone(String phone);
    SysUser getByWechatId(String wechatId);
    SysUser getByYouzanId(String youzanId);
    
    // ç”¨æˆ·ç®¡ç†
    void updateLastLoginTime(String userId);
    
    // å¯†ç ç®¡ç†
    boolean validatePassword(String rawPassword, String encodedPassword);
    String encodePassword(String rawPassword);
    
    // çŠ¶æ€æ£€æŸ¥
    boolean isUserStatusNormal(SysUser user);
}
```

### 4. JWTå·¥å…·ç±» (JwtUtil)

#### æ ¸å¿ƒåŠŸèƒ½
```java
@Component
public class JwtUtil {
    
    // ä»¤ç‰Œç”Ÿæˆ
    public String generateToken(String userId, String username);
    public String generateToken(String userId, String username, Map<String, Object> claims);
    
    // ä»¤ç‰ŒéªŒè¯
    public boolean validateToken(String token);
    
    // ä»¤ç‰Œè§£æ
    public String getUserIdFromToken(String token);
    public String getUsernameFromToken(String token);
    public <T> T getClaimFromToken(String token, String claimName, Class<T> claimType);
    
    // è¿‡æœŸæ—¶é—´
    public long getExpirationTime(String token);
}
```

### 5. JWTä»¤ç‰Œç®¡ç†å™¨ (JwtTokenManager)

#### æ ¸å¿ƒåŠŸèƒ½
```java
@Component
public class JwtTokenManager {
    
    // é»‘åå•ç®¡ç†
    public void addToBlacklist(String token, long expirationTime);
    public boolean isBlacklisted(String token);
    
    // ç”¨æˆ·ä»¤ç‰Œç®¡ç†
    public void updateUserToken(String userId, String token, long expirationTime);
    public boolean isUserTokenValid(String userId, String token);
    public void removeUserToken(String userId);
    
    // ä»¤ç‰ŒéªŒè¯
    public boolean isValid(String token);
    public void removeFromValid(String token);
}
```

### 6. JWTæ‹¦æˆªå™¨ (JwtInterceptor)

#### æ‹¦æˆªé€»è¾‘
```java
@Component
public class JwtInterceptor implements HandlerInterceptor {
    
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {
        // 1. è·å–token
        String token = request.getHeader("Authorization");
        
        // 2. æ£€æŸ¥tokenæ˜¯å¦åœ¨é»‘åå•ä¸­
        if (jwtTokenManager.isBlacklisted(token)) {
            throw new BusinessException(ErrorCode.UNAUTHORIZED, "è®¤è¯ä»¤ç‰Œå·²å¤±æ•ˆ");
        }
        
        // 3. éªŒè¯tokenæ˜¯å¦æœ‰æ•ˆ
        if (!jwtUtil.validateToken(token)) {
            throw new BusinessException(ErrorCode.UNAUTHORIZED, "è®¤è¯ä»¤ç‰Œæ— æ•ˆæˆ–å·²è¿‡æœŸ");
        }
        
        // 4. è®¾ç½®ç”¨æˆ·ä¿¡æ¯åˆ°è¯·æ±‚å±æ€§
        String userId = jwtUtil.getUserIdFromToken(token);
        String username = jwtUtil.getUsernameFromToken(token);
        request.setAttribute("userId", userId);
        request.setAttribute("username", username);
        
        return true;
    }
}
```

## ğŸ—„ï¸ æ•°æ®æ¨¡å‹

### ç”¨æˆ·å®ä½“ (SysUser)
```java
@Data
@TableName("sys_user")
public class SysUser extends BaseEntity {
    
    @TableId(value = "user_id", type = IdType.ASSIGN_ID)
    private String userId;                    // ç”¨æˆ·ID
    
    private String phone;                     // æ‰‹æœºå·
    private String wechatId;                  // å¾®ä¿¡ç”¨æˆ·ID
    private String youzanId;                  // æœ‰èµç”¨æˆ·ID
    private String username;                  // ç”¨æˆ·å
    private String password;                  // å¯†ç (BCryptåŠ å¯†)
    private String nickname;                  // æ˜µç§°
    private String avatar;                    // å¤´åƒURL
    private String email;                     // é‚®ç®±
    private Integer gender;                   // æ€§åˆ«ï¼š0-æœªçŸ¥ï¼Œ1-ç”·ï¼Œ2-å¥³
    private LocalDate birthday;               // ç”Ÿæ—¥
    private Integer status;                   // çŠ¶æ€ï¼š1-æ­£å¸¸ï¼Œ2-ç¦ç”¨ï¼Œ3-å¾…å®¡æ ¸ï¼Œ4-å·²åˆ é™¤
    private Integer userType;                 // ç”¨æˆ·ç±»å‹ï¼š1-ç³»ç»Ÿç®¡ç†å‘˜ï¼Œ2-å‘å¸ƒè€…ï¼Œ3-æ¥å—è€…
    private String profileId;                 // æ‰©å±•ä¿¡æ¯ID
    private LocalDateTime lastLoginTime;      // æœ€åç™»å½•æ—¶é—´
}
```

### DTOè®¾è®¡

#### ç™»å½•è¯·æ±‚ (LoginRequest)
```java
@Data
public class LoginRequest {
    private String username;                  // ç”¨æˆ·å
    private String password;                  // å¯†ç 
}
```

#### ç™»å½•å“åº” (LoginResponse)
```java
@Data
public class LoginResponse {
    private String userId;                    // ç”¨æˆ·ID
    private String username;                  // ç”¨æˆ·å
    private String nickname;                  // æ˜µç§°
    private String avatar;                    // å¤´åƒ
    private Integer userType;                 // ç”¨æˆ·ç±»å‹
    private String userTypeDesc;              // ç”¨æˆ·ç±»å‹æè¿°
    private String token;                     // è®¿é—®ä»¤ç‰Œ
    private String tokenType = "Bearer";      // ä»¤ç‰Œç±»å‹
    private Long expiresIn;                   // è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
}
```

#### ç”¨æˆ·ä¿¡æ¯å“åº” (UserInfoResponse)
```java
@Data
public class UserInfoResponse {
    private String userId;                    // ç”¨æˆ·ID
    private String username;                  // ç”¨æˆ·å
    private String nickname;                  // æ˜µç§°
    private String avatar;                    // å¤´åƒURL
    private String email;                     // é‚®ç®±
    private String phone;                     // æ‰‹æœºå·
    private String wechatId;                  // å¾®ä¿¡ç”¨æˆ·ID
    private String youzanId;                  // æœ‰èµç”¨æˆ·ID
    private Integer gender;                   // æ€§åˆ«
    private LocalDate birthday;               // ç”Ÿæ—¥
    private Integer status;                   // çŠ¶æ€
    private Integer userType;                 // ç”¨æˆ·ç±»å‹
    private String userTypeDesc;              // ç”¨æˆ·ç±»å‹æè¿°
    private String profileId;                 // æ‰©å±•ä¿¡æ¯ID
    private LocalDateTime lastLoginTime;      // æœ€åç™»å½•æ—¶é—´
    private LocalDateTime createdTime;        // åˆ›å»ºæ—¶é—´
}
```

## ğŸ” å®‰å…¨è®¾è®¡

### 1. å¯†ç å®‰å…¨
- **åŠ å¯†ç®—æ³•**: BCrypt (å¼ºåº¦12)
- **å¯†ç éªŒè¯**: ä½¿ç”¨Spring Securityçš„PasswordEncoder
- **å¯†ç å­˜å‚¨**: æ•°æ®åº“ä¸­åªå­˜å‚¨åŠ å¯†åçš„å¯†ç 

### 2. JWTå®‰å…¨
- **ç­¾åç®—æ³•**: HMAC-SHA256
- **å¯†é’¥ç®¡ç†**: é€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†JWTå¯†é’¥
- **è¿‡æœŸæ—¶é—´**: å¯é…ç½®çš„ä»¤ç‰Œè¿‡æœŸæ—¶é—´
- **åˆ·æ–°æœºåˆ¶**: æ”¯æŒä»¤ç‰Œåˆ·æ–°

### 3. ä»¤ç‰Œç®¡ç†
- **é»‘åå•æœºåˆ¶**: ç™»å‡ºçš„ä»¤ç‰ŒåŠ å…¥Redisé»‘åå•
- **ç”¨æˆ·ä»¤ç‰Œç®¡ç†**: æ¯ä¸ªç”¨æˆ·åªä¿ç•™æœ€æ–°çš„æœ‰æ•ˆä»¤ç‰Œ
- **è‡ªåŠ¨è¿‡æœŸ**: Redisè‡ªåŠ¨æ¸…ç†è¿‡æœŸçš„ä»¤ç‰Œ

### 4. æƒé™æ§åˆ¶
- **ç®€åŒ–æƒé™æ¨¡å‹**: åŸºäºç”¨æˆ·ç±»å‹çš„æƒé™æ§åˆ¶
- **æƒé™éªŒè¯**: åœ¨Serviceå±‚è¿›è¡Œæƒé™éªŒè¯
- **æ‹¦æˆªå™¨éªŒè¯**: åœ¨è¯·æ±‚æ‹¦æˆªå™¨ä¸­è¿›è¡Œä»¤ç‰ŒéªŒè¯

## âš™ï¸ é…ç½®ç®¡ç†

### åº”ç”¨é…ç½®
```yaml
spring:
  application:
    name: service-auth
  datasource:
    url: jdbc:mysql://localhost:3306/banyu
    username: ${MYSQL_USERNAME:root}
    password: ${MYSQL_PASSWORD:root}
  redis:
    host: ${REDIS_HOST:localhost}
    port: ${REDIS_PORT:6379}
    password: ${REDIS_PASSWORD:}
    database: ${REDIS_DATABASE:0}

# JWTé…ç½®
jwt:
  secret: ${JWT_SECRET:your-secret-key}
  expiration: ${JWT_EXPIRATION:86400}        # 24å°æ—¶
  refresh-expiration: ${JWT_REFRESH_EXPIRATION:604800}  # 7å¤©
  enable-blacklist: ${JWT_ENABLE_BLACKLIST:true}
  blacklist-prefix: "jwt:blacklist:"
  valid-token-prefix: "jwt:valid:"
  header: "Authorization"

# MyBatis Plusé…ç½®
mybatis-plus:
  configuration:
    map-underscore-to-camel-case: true
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      id-type: assign_id
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0
```

### ç¯å¢ƒé…ç½®
- **å¼€å‘ç¯å¢ƒ**: `application-dev.yml`
- **æµ‹è¯•ç¯å¢ƒ**: `application-test.yml`
- **ç”Ÿäº§ç¯å¢ƒ**: `application-prod.yml`

## ğŸ”„ ä¸šåŠ¡æµç¨‹

### 1. ç”¨æˆ·ç™»å½•æµç¨‹
```
1. å®¢æˆ·ç«¯å‘é€ç™»å½•è¯·æ±‚
   â†“
2. AuthControlleræ¥æ”¶è¯·æ±‚
   â†“
3. AuthServiceéªŒè¯ç”¨æˆ·åå’Œå¯†ç 
   â†“
4. æ£€æŸ¥ç”¨æˆ·çŠ¶æ€æ˜¯å¦æ­£å¸¸
   â†“
5. æ›´æ–°ç”¨æˆ·æœ€åç™»å½•æ—¶é—´
   â†“
6. ç”ŸæˆJWTä»¤ç‰Œï¼ˆåŒ…å«ç”¨æˆ·ç±»å‹ä¿¡æ¯ï¼‰
   â†“
7. å°†ä»¤ç‰Œå­˜å‚¨åˆ°Redis
   â†“
8. è¿”å›ç™»å½•å“åº”ï¼ˆåŒ…å«ä»¤ç‰Œå’Œç”¨æˆ·ä¿¡æ¯ï¼‰
```

### 2. è¯·æ±‚è®¤è¯æµç¨‹
```
1. å®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼ˆæºå¸¦JWTä»¤ç‰Œï¼‰
   â†“
2. JwtInterceptoræ‹¦æˆªè¯·æ±‚
   â†“
3. æ£€æŸ¥ä»¤ç‰Œæ˜¯å¦åœ¨é»‘åå•ä¸­
   â†“
4. éªŒè¯JWTä»¤ç‰Œæ ¼å¼å’Œç­¾å
   â†“
5. æ£€æŸ¥ä»¤ç‰Œæ˜¯å¦è¿‡æœŸ
   â†“
6. ä»ä»¤ç‰Œä¸­æå–ç”¨æˆ·ä¿¡æ¯
   â†“
7. è®¾ç½®ç”¨æˆ·ä¿¡æ¯åˆ°è¯·æ±‚å±æ€§
   â†“
8. ç»§ç»­å¤„ç†ä¸šåŠ¡è¯·æ±‚
```

### 3. ç”¨æˆ·ç™»å‡ºæµç¨‹
```
1. å®¢æˆ·ç«¯å‘é€ç™»å‡ºè¯·æ±‚
   â†“
2. AuthControlleræ¥æ”¶è¯·æ±‚
   â†“
3. ä»è¯·æ±‚å¤´ä¸­æå–JWTä»¤ç‰Œ
   â†“
4. å°†ä»¤ç‰ŒåŠ å…¥Redisé»‘åå•
   â†“
5. ç§»é™¤ç”¨æˆ·çš„å½“å‰ä»¤ç‰Œ
   â†“
6. è¿”å›ç™»å‡ºæˆåŠŸå“åº”
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. ç¼“å­˜ç­–ç•¥
- **Redisç¼“å­˜**: JWTä»¤ç‰Œå’Œé»‘åå•ä¿¡æ¯
- **æœ¬åœ°ç¼“å­˜**: ç”¨æˆ·ä¿¡æ¯ç¼“å­˜ï¼ˆå¯é€‰ï¼‰
- **ç¼“å­˜è¿‡æœŸ**: è‡ªåŠ¨è¿‡æœŸæœºåˆ¶

### 2. æ•°æ®åº“ä¼˜åŒ–
- **ç´¢å¼•ä¼˜åŒ–**: ç”¨æˆ·åã€æ‰‹æœºå·ç­‰å­—æ®µå»ºç«‹ç´¢å¼•
- **æŸ¥è¯¢ä¼˜åŒ–**: ä½¿ç”¨MyBatis Plusçš„åˆ†é¡µæŸ¥è¯¢
- **è¿æ¥æ± **: é…ç½®åˆé€‚çš„æ•°æ®åº“è¿æ¥æ± 

### 3. JWTä¼˜åŒ–
- **ä»¤ç‰Œå¤§å°**: æ§åˆ¶JWTä»¤ç‰Œçš„å¤§å°
- **å£°æ˜ç²¾ç®€**: åªåŒ…å«å¿…è¦çš„ç”¨æˆ·ä¿¡æ¯
- **è¿‡æœŸæ—¶é—´**: åˆç†è®¾ç½®ä»¤ç‰Œè¿‡æœŸæ—¶é—´

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### 1. å•å…ƒæµ‹è¯•
- **Serviceå±‚æµ‹è¯•**: æµ‹è¯•ä¸šåŠ¡é€»è¾‘
- **Utilå±‚æµ‹è¯•**: æµ‹è¯•å·¥å…·ç±»åŠŸèƒ½
- **Mapperå±‚æµ‹è¯•**: æµ‹è¯•æ•°æ®è®¿é—®

### 2. é›†æˆæµ‹è¯•
- **APIæµ‹è¯•**: æµ‹è¯•RESTæ¥å£
- **æ•°æ®åº“æµ‹è¯•**: æµ‹è¯•æ•°æ®åº“æ“ä½œ
- **Redisæµ‹è¯•**: æµ‹è¯•ç¼“å­˜åŠŸèƒ½

### 3. æ€§èƒ½æµ‹è¯•
- **å¹¶å‘æµ‹è¯•**: æµ‹è¯•å¹¶å‘ç™»å½•æ€§èƒ½
- **å‹åŠ›æµ‹è¯•**: æµ‹è¯•ç³»ç»Ÿæ‰¿è½½èƒ½åŠ›
- **ç¨³å®šæ€§æµ‹è¯•**: æµ‹è¯•é•¿æœŸè¿è¡Œç¨³å®šæ€§

## ğŸ“ˆ ç›‘æ§æŒ‡æ ‡

### 1. ä¸šåŠ¡æŒ‡æ ‡
- **ç™»å½•æˆåŠŸç‡**: ç™»å½•æˆåŠŸæ¬¡æ•°/æ€»ç™»å½•æ¬¡æ•°
- **ç™»å½•å“åº”æ—¶é—´**: ç™»å½•æ¥å£çš„å¹³å‡å“åº”æ—¶é—´
- **æ´»è·ƒç”¨æˆ·æ•°**: å½“å‰åœ¨çº¿ç”¨æˆ·æ•°é‡

### 2. æŠ€æœ¯æŒ‡æ ‡
- **JWTä»¤ç‰Œç”Ÿæˆæ—¶é—´**: ä»¤ç‰Œç”Ÿæˆçš„å¹³å‡æ—¶é—´
- **Redisæ“ä½œå»¶è¿Ÿ**: Redisè¯»å†™çš„å¹³å‡å»¶è¿Ÿ
- **æ•°æ®åº“æŸ¥è¯¢æ—¶é—´**: æ•°æ®åº“æŸ¥è¯¢çš„å¹³å‡æ—¶é—´

### 3. å®‰å…¨æŒ‡æ ‡
- **å¼‚å¸¸ç™»å½•æ¬¡æ•°**: å¯†ç é”™è¯¯ç­‰å¼‚å¸¸ç™»å½•æ¬¡æ•°
- **ä»¤ç‰Œå¤±æ•ˆæ¬¡æ•°**: ä»¤ç‰ŒéªŒè¯å¤±è´¥çš„æ¬¡æ•°
- **é»‘åå•å¤§å°**: å½“å‰é»‘åå•ä¸­çš„ä»¤ç‰Œæ•°é‡

## ğŸ”® æ‰©å±•è§„åˆ’

### 1. åŠŸèƒ½æ‰©å±•
- **å¤šå› å­è®¤è¯**: æ”¯æŒçŸ­ä¿¡éªŒè¯ç ã€é‚®ç®±éªŒè¯ç­‰
- **OAuth2é›†æˆ**: æ”¯æŒç¬¬ä¸‰æ–¹ç™»å½•
- **å•ç‚¹ç™»å½•**: æ”¯æŒSSOåŠŸèƒ½

### 2. å®‰å…¨å¢å¼º
- **ä»¤ç‰Œè½®æ¢**: å®šæœŸæ›´æ¢JWTå¯†é’¥
- **å¼‚å¸¸æ£€æµ‹**: æ£€æµ‹å¼‚å¸¸ç™»å½•è¡Œä¸º
- **å®¡è®¡æ—¥å¿—**: è®°å½•è¯¦ç»†çš„è®¤è¯æ—¥å¿—

### 3. æ€§èƒ½ä¼˜åŒ–
- **åˆ†å¸ƒå¼ç¼“å­˜**: ä½¿ç”¨Redisé›†ç¾¤
- **è´Ÿè½½å‡è¡¡**: æ”¯æŒå¤šå®ä¾‹éƒ¨ç½²
- **å¼‚æ­¥å¤„ç†**: å¼‚æ­¥å¤„ç†éå…³é”®æ“ä½œ

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2025-01-27  
**ç»´æŠ¤äººå‘˜**: scccy