# service-user æ¨¡å—è®¾è®¡æ–‡æ¡£

## ğŸ“‹ æ¨¡å—æ¦‚è¿°

### åŸºæœ¬ä¿¡æ¯
- **æ¨¡å—åç§°**: service-user
- **æ¨¡å—ç±»å‹**: å¾®æœåŠ¡æ¨¡å—
- **ä¸»è¦èŒè´£**: ç”¨æˆ·ä¿¡æ¯ç®¡ç†ã€ç”¨æˆ·æ¡£æ¡ˆç»´æŠ¤ã€å¤´åƒç®¡ç†ã€ç”¨æˆ·æŸ¥è¯¢æœåŠ¡
- **æŠ€æœ¯æ ˆ**: Spring Boot + MyBatis Plus + Feign + Redis + OSS
- **ä½œè€…**: scccy
- **åˆ›å»ºæ—¶é—´**: 2025-01-27

### è®¾è®¡ç†å¿µ
service-useræ¨¡å—ä½œä¸ºç”¨æˆ·ä¿¡æ¯ç®¡ç†ä¸­å¿ƒï¼Œè´Ÿè´£ç”¨æˆ·åŸºç¡€ä¿¡æ¯çš„å¢åˆ æ”¹æŸ¥ã€ç”¨æˆ·æ¡£æ¡ˆç®¡ç†ã€å¤´åƒä¸Šä¼ ç­‰åŠŸèƒ½ã€‚æ¨¡å—é‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œé€šè¿‡Feignå®¢æˆ·ç«¯ä¸å…¶ä»–æœåŠ¡è¿›è¡Œé€šä¿¡ï¼Œæ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²å’Œæ°´å¹³æ‰©å±•ã€‚

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒæ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Controller    â”‚    â”‚     Service     â”‚    â”‚     Mapper      â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ UserController  â”‚â”€â”€â”€â–¶â”‚  SysUserService â”‚â”€â”€â”€â–¶â”‚  SysUserMapper  â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Feign Client  â”‚    â”‚      Util       â”‚    â”‚    Database     â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ AuthFeignClient â”‚    â”‚  UserUtil       â”‚    â”‚    sys_user     â”‚
â”‚ OssFeignClient  â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸šåŠ¡æ¨¡å‹
```
ç”¨æˆ·ç®¡ç†æµç¨‹:
1. ç”¨æˆ·æ³¨å†Œ/åˆ›å»º
2. ç”¨æˆ·ä¿¡æ¯ç»´æŠ¤
3. å¤´åƒä¸Šä¼ ç®¡ç†
4. ç”¨æˆ·æŸ¥è¯¢æœåŠ¡

å¤–éƒ¨æœåŠ¡é›†æˆ:
1. è®¤è¯æœåŠ¡é›†æˆ (service-auth)
2. æ–‡ä»¶å­˜å‚¨é›†æˆ (aliyun-oss)
3. ç”¨æˆ·æ¡£æ¡ˆæœåŠ¡é›†æˆ
```

## ğŸ“ ç›®å½•ç»“æ„

```
service-user/
â”œâ”€â”€ src/main/java/com/origin/user/
â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â””â”€â”€ UserController.java              # ç”¨æˆ·ç®¡ç†æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â”œâ”€â”€ SysUserService.java              # ç”¨æˆ·æœåŠ¡æ¥å£
â”‚   â”‚   â”œâ”€â”€ UserProfileService.java          # ç”¨æˆ·æ¡£æ¡ˆæœåŠ¡æ¥å£
â”‚   â”‚   â””â”€â”€ impl/
â”‚   â”‚       â”œâ”€â”€ SysUserServiceImpl.java      # ç”¨æˆ·æœåŠ¡å®ç°
â”‚   â”‚       â””â”€â”€ UserProfileServiceImpl.java  # ç”¨æˆ·æ¡£æ¡ˆæœåŠ¡å®ç°
â”‚   â”œâ”€â”€ entity/
â”‚   â”‚   â””â”€â”€ SysUser.java                     # ç”¨æˆ·å®ä½“ç±»
â”‚   â”œâ”€â”€ mapper/
â”‚   â”‚   â””â”€â”€ SysUserMapper.java               # ç”¨æˆ·æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”œâ”€â”€ UserCreateRequest.java           # ç”¨æˆ·åˆ›å»ºè¯·æ±‚DTO
â”‚   â”‚   â”œâ”€â”€ UserUpdateRequest.java           # ç”¨æˆ·æ›´æ–°è¯·æ±‚DTO
â”‚   â”‚   â”œâ”€â”€ UserQueryRequest.java            # ç”¨æˆ·æŸ¥è¯¢è¯·æ±‚DTO
â”‚   â”‚   â””â”€â”€ AvatarResponse.java              # å¤´åƒå“åº”DTO
â”‚   â”œâ”€â”€ feign/
â”‚   â”‚   â”œâ”€â”€ AuthFeignClient.java             # è®¤è¯æœåŠ¡Feignå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ AuthFeignClientFallback.java     # è®¤è¯æœåŠ¡é™çº§å¤„ç†
â”‚   â”‚   â”œâ”€â”€ OssFileFeignClient.java          # OSSæ–‡ä»¶æœåŠ¡Feignå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ OssFileFeignClientFallback.java  # OSSæ–‡ä»¶æœåŠ¡é™çº§å¤„ç†
â”‚   â”‚   â”œâ”€â”€ UserFeignClient.java             # ç”¨æˆ·æœåŠ¡Feignå®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ UserFeignClientFallback.java     # ç”¨æˆ·æœåŠ¡é™çº§å¤„ç†
â”‚   â”œâ”€â”€ exception/
â”‚   â”‚   â””â”€â”€ UserExceptionHandler.java        # ç”¨æˆ·å¼‚å¸¸å¤„ç†
â”‚   â””â”€â”€ ServiceUserApplication.java          # å¯åŠ¨ç±»
â””â”€â”€ src/main/resources/
    â”œâ”€â”€ application.yml                      # é…ç½®æ–‡ä»¶
    â””â”€â”€ mapper/
        â””â”€â”€ SysUserMapper.xml                # MyBatisæ˜ å°„æ–‡ä»¶
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶

### 1. æ§åˆ¶å™¨ (UserController)

#### ä¸»è¦æ¥å£
```java
@RestController
@RequestMapping("/service/user")
public class UserController {
    
    // åˆ›å»ºç”¨æˆ·
    @PostMapping
    public ResultData<SysUser> createUser(@RequestPart("userInfo") @Valid UserCreateRequest request,
                                         @RequestPart(value = "avatarFile", required = false) MultipartFile avatarFile);
    
    // è·å–ç”¨æˆ·ä¿¡æ¯
    @GetMapping("/{userId}")
    public ResultData<SysUser> getUserInfo(@PathVariable String userId);
    
    // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
    @PostMapping("/{userId}")
    public ResultData<SysUser> updateUser(@PathVariable String userId,
                                         @RequestPart("userInfo") @Valid UserUpdateRequest request,
                                         @RequestPart(value = "avatarFile", required = false) MultipartFile avatarFile);
    
    // åˆ é™¤ç”¨æˆ·
    @PostMapping("/{userId}/delete")
    public ResultData<String> deleteUser(@PathVariable String userId);
    
    // ç”¨æˆ·åˆ—è¡¨æŸ¥è¯¢
    @GetMapping("/list")
    public ResultData<IPage<SysUser>> getUserList(@Valid UserQueryRequest request);
    
    // æ‰¹é‡åˆ é™¤ç”¨æˆ·
    @PostMapping("/batch/delete")
    public ResultData<String> batchDeleteUsers(@RequestBody List<String> userIds);
    
    // è·å–ç”¨æˆ·å¤´åƒä¿¡æ¯
    @GetMapping("/{userId}/avatar")
    public ResultData<AvatarResponse> getAvatarInfo(@PathVariable String userId);
    
    // å¥åº·æ£€æŸ¥
    @GetMapping("/test")
    public ResultData<String> test(HttpServletRequest httpRequest);
}
```

#### æ¥å£è¯´æ˜
| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|------|
| åˆ›å»ºç”¨æˆ· | POST | `/service/user` | åˆ›å»ºæ–°ç”¨æˆ·ï¼Œæ”¯æŒå¤´åƒä¸Šä¼  |
| è·å–ç”¨æˆ·ä¿¡æ¯ | GET | `/service/user/{userId}` | æ ¹æ®ç”¨æˆ·IDè·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ |
| æ›´æ–°ç”¨æˆ·ä¿¡æ¯ | POST | `/service/user/{userId}` | æ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼Œæ”¯æŒå¤´åƒæ›´æ–° |
| åˆ é™¤ç”¨æˆ· | POST | `/service/user/{userId}/delete` | è½¯åˆ é™¤æŒ‡å®šç”¨æˆ· |
| ç”¨æˆ·åˆ—è¡¨æŸ¥è¯¢ | GET | `/service/user/list` | åˆ†é¡µæŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ï¼Œæ”¯æŒå¤šæ¡ä»¶ç­›é€‰ |
| æ‰¹é‡åˆ é™¤ç”¨æˆ· | POST | `/service/user/batch/delete` | æ‰¹é‡è½¯åˆ é™¤å¤šä¸ªç”¨æˆ· |
| è·å–ç”¨æˆ·å¤´åƒä¿¡æ¯ | GET | `/service/user/{userId}/avatar` | è·å–ç”¨æˆ·çš„å¤´åƒURLå’Œç›¸å…³ä¿¡æ¯ |
| å¥åº·æ£€æŸ¥ | GET | `/service/user/test` | æœåŠ¡å¥åº·æ£€æŸ¥æ¥å£ |

### 2. æœåŠ¡å±‚ (SysUserService)

#### æ ¸å¿ƒæ–¹æ³•
```java
public interface SysUserService {
    
    // åˆ›å»ºç”¨æˆ·ï¼ˆæ”¯æŒå¤´åƒï¼‰
    SysUser createUserWithAvatar(UserCreateRequest request, MultipartFile avatarFile);
    
    // æ ¹æ®IDè·å–ç”¨æˆ·
    SysUser getUserById(String userId);
    
    // æ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼ˆæ”¯æŒå¤´åƒï¼‰
    SysUser updateUserWithAvatar(String userId, UserUpdateRequest request, MultipartFile avatarFile);
    
    // åˆ é™¤ç”¨æˆ·
    boolean deleteUser(String userId);
    
    // åˆ†é¡µæŸ¥è¯¢ç”¨æˆ·
    IPage<SysUser> getUserPage(UserQueryRequest request);
    
    // æ‰¹é‡åˆ é™¤ç”¨æˆ·
    int batchDeleteUsers(List<String> userIds);
    
    // è·å–å¤´åƒä¿¡æ¯
    AvatarResponse getAvatarInfo(String userId);
}
```

#### ä¸šåŠ¡é€»è¾‘
```java
// åˆ›å»ºç”¨æˆ·ä¸šåŠ¡é€»è¾‘
public SysUser createUserWithAvatar(UserCreateRequest request, MultipartFile avatarFile) {
    // 1. éªŒè¯ç”¨æˆ·ä¿¡æ¯
    // 2. è°ƒç”¨è®¤è¯æœåŠ¡åŠ å¯†å¯†ç 
    // 3. ä¸Šä¼ å¤´åƒåˆ°OSSï¼ˆå¦‚æœæœ‰ï¼‰
    // 4. ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°æ•°æ®åº“
    // 5. è¿”å›ç”¨æˆ·ä¿¡æ¯
}
```

### 3. Feignå®¢æˆ·ç«¯åˆ—è¡¨

#### ä¾èµ–çš„å¤–éƒ¨æœåŠ¡
| æœåŠ¡åç§° | Feignå®¢æˆ·ç«¯ | ä¸»è¦ç”¨é€” | æ¥å£è·¯å¾„ |
|----------|-------------|----------|----------|
| service-auth | AuthFeignClient | ç”¨æˆ·è®¤è¯ã€å¯†ç åŠ å¯†éªŒè¯ã€æƒé™éªŒè¯ | `/service/auth` |
| aliyun-oss | OssFileFeignClient | æ–‡ä»¶ä¸Šä¼ ã€å¤´åƒç®¡ç† | `/tp/oss` |
| service-user | UserFeignClient | ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢ï¼ˆå†…éƒ¨è°ƒç”¨ï¼‰ | `/service/user` |

#### Feignå®¢æˆ·ç«¯æ¥å£
```java
@FeignClient(name = "service-auth", path = "/service/auth", fallback = AuthFeignClientFallback.class)
public interface AuthFeignClient {
    
    // ç”¨æˆ·ç™»å½•
    @PostMapping("/login")
    ResultData login(@RequestBody LoginRequest loginRequest);
    
    // éªŒè¯JWTä»¤ç‰Œ
    @PostMapping("/validate")
    ResultData<Boolean> validateToken(@RequestParam("token") String token);
    
    // è·å–ç”¨æˆ·ä¿¡æ¯
    @GetMapping("/user/info")
    ResultData<SysUser> getUserInfo(@RequestParam("userId") String userId);
    
    // å¯†ç åŠ å¯†
    @PostMapping("/password/encrypt")
    ResultData<PasswordEncryptResponse> encryptPassword(@RequestBody PasswordEncryptRequest request);
    
    // å¯†ç éªŒè¯
    @PostMapping("/password/verify")
    ResultData<Boolean> verifyPassword(@RequestBody PasswordEncryptRequest request);
}

@FeignClient(name = "aliyun-oss", path = "/tp/oss", fallback = OssFileFeignClientFallback.class)
public interface OssFileFeignClient {
    
    // ä¸Šä¼ æ–‡ä»¶åˆ°OSS
    @PostMapping("/upload")
    ResultData<FileUploadResponse> uploadFile(@RequestBody FileUploadRequest request);
    
    // è·å–æ–‡ä»¶è®¿é—®URL
    @GetMapping("/url/{fileId}")
    ResultData<String> getFileUrl(@PathVariable("fileId") String fileId);
}
```

#### Feigné™çº§å¤„ç†
```java
@Component
public class AuthFeignClientFallback implements AuthFeignClient {
    
    @Override
    public ResultData login(LoginRequest loginRequest) {
        return ResultData.error(ErrorCode.SERVICE_UNAVAILABLE, "è®¤è¯æœåŠ¡æš‚æ—¶ä¸å¯ç”¨");
    }
    
    @Override
    public ResultData<Boolean> validateToken(String token) {
        return ResultData.error(ErrorCode.SERVICE_UNAVAILABLE, "è®¤è¯æœåŠ¡æš‚æ—¶ä¸å¯ç”¨");
    }
}

@Component
public class OssFileFeignClientFallback implements OssFileFeignClient {
    
    @Override
    public ResultData<FileUploadResponse> uploadFile(FileUploadRequest request) {
        return ResultData.error(ErrorCode.SERVICE_UNAVAILABLE, "æ–‡ä»¶æœåŠ¡æš‚æ—¶ä¸å¯ç”¨");
    }
}
```

### 4. å·¥å…·ç±» (UserUtil)

#### æ ¸å¿ƒåŠŸèƒ½
```java
@Component
public class UserUtil {
    
    // éªŒè¯ç”¨æˆ·ä¿¡æ¯
    public void validateUserInfo(UserCreateRequest request);
    
    // å¤„ç†å¤´åƒæ–‡ä»¶
    public String processAvatarFile(MultipartFile avatarFile);
    
    // ç”Ÿæˆç”¨æˆ·ID
    public String generateUserId();
    
    // éªŒè¯ç”¨æˆ·æƒé™
    public boolean validateUserPermission(String userId, String operation);
}
```

## ğŸ—„ï¸ æ•°æ®æ¨¡å‹

### å®ä½“ç±» (SysUser)
```java
@Data
@TableName("sys_user")
public class SysUser extends BaseEntity {
    
    @TableId(value = "user_id", type = IdType.ASSIGN_ID)
    private String userId;                    // ç”¨æˆ·ID
    
    private String username;                  // ç”¨æˆ·å
    private String password;                  // å¯†ç ï¼ˆåŠ å¯†ï¼‰
    private String nickname;                  // æ˜µç§°
    private String email;                     // é‚®ç®±
    private String phone;                     // æ‰‹æœºå·
    private String avatar;                    // å¤´åƒURL
    private Integer userType;                 // ç”¨æˆ·ç±»å‹
    private Integer status;                   // ç”¨æˆ·çŠ¶æ€
    private LocalDateTime lastLoginTime;      // æœ€åç™»å½•æ—¶é—´
    private String lastLoginIp;               // æœ€åç™»å½•IP
}
```

### DTOè®¾è®¡

#### è¯·æ±‚DTO (UserCreateRequest)
```java
@Data
public class UserCreateRequest {
    private String username;                  // ç”¨æˆ·å
    private String password;                  // å¯†ç 
    private String nickname;                  // æ˜µç§°
    private String email;                     // é‚®ç®±
    private String phone;                     // æ‰‹æœºå·
    private Integer userType;                 // ç”¨æˆ·ç±»å‹
}
```

#### è¯·æ±‚DTO (UserUpdateRequest)
```java
@Data
public class UserUpdateRequest {
    private String nickname;                  // æ˜µç§°
    private String email;                     // é‚®ç®±
    private String phone;                     // æ‰‹æœºå·
}
```

#### è¯·æ±‚DTO (UserQueryRequest)
```java
@Data
public class UserQueryRequest {
    private Integer current = 1;              // å½“å‰é¡µç 
    private Integer size = 10;                // æ¯é¡µå¤§å°
    private String keyword;                   // å…³é”®è¯
    private Integer userType;                 // ç”¨æˆ·ç±»å‹
    private Integer status;                   // ç”¨æˆ·çŠ¶æ€
    private String sortField;                 // æ’åºå­—æ®µ
    private String sortOrder = "desc";        // æ’åºæ–¹å‘
}
```

#### å“åº”DTO (AvatarResponse)
```java
@Data
public class AvatarResponse {
    private String userId;                    // ç”¨æˆ·ID
    private String avatarUrl;                 // å¤´åƒURL
    private String avatarThumbnail;           // å¤´åƒç¼©ç•¥å›¾URL
    private Long fileSize;                    // æ–‡ä»¶å¤§å°
    private String fileType;                  // æ–‡ä»¶ç±»å‹
    private LocalDateTime uploadTime;         // ä¸Šä¼ æ—¶é—´
}
```

## ğŸ” å®‰å…¨è®¾è®¡

### 1. è®¤è¯æˆæƒ
- **JWTéªŒè¯**: é€šè¿‡Feignå®¢æˆ·ç«¯è°ƒç”¨è®¤è¯æœåŠ¡éªŒè¯ç”¨æˆ·èº«ä»½
- **æƒé™æ§åˆ¶**: åŸºäºç”¨æˆ·ç±»å‹å’ŒçŠ¶æ€è¿›è¡Œæƒé™æ§åˆ¶
- **æ•°æ®éš”ç¦»**: ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„ä¿¡æ¯ï¼Œç®¡ç†å‘˜å¯ä»¥è®¿é—®æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯
- **æ“ä½œå®¡è®¡**: è®°å½•æ‰€æœ‰ç”¨æˆ·æ“ä½œçš„å®¡è®¡æ—¥å¿—

### 2. æ•°æ®å®‰å…¨
- **å¯†ç å®‰å…¨**: å¯†ç é€šè¿‡è®¤è¯æœåŠ¡åŠ å¯†å­˜å‚¨
- **è¾“å…¥éªŒè¯**: æ‰€æœ‰è¾“å…¥å‚æ•°è¿›è¡ŒéªŒè¯å’Œè¿‡æ»¤
- **SQLæ³¨å…¥é˜²æŠ¤**: ä½¿ç”¨MyBatis Pluså‚æ•°åŒ–æŸ¥è¯¢
- **æ•æ„Ÿæ•°æ®å¤„ç†**: å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ä¸è¿”å›ç»™å‰ç«¯

### 3. æ¥å£å®‰å…¨
- **æ¥å£é™æµ**: å¯¹é«˜é¢‘æ¥å£è¿›è¡Œé™æµä¿æŠ¤
- **å¼‚å¸¸å¤„ç†**: ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†æœºåˆ¶
- **æ—¥å¿—è®°å½•**: å…³é”®æ“ä½œçš„æ—¥å¿—è®°å½•
- **é“¾è·¯è¿½è¸ª**: æ”¯æŒè¯·æ±‚é“¾è·¯è¿½è¸ª

## âš™ï¸ é…ç½®ç®¡ç†

### åº”ç”¨é…ç½®
```yaml
spring:
  application:
    name: service-user
  datasource:
    url: jdbc:mysql://localhost:3306/banyu
    username: ${MYSQL_USERNAME:root}
    password: ${MYSQL_PASSWORD:root}
  redis:
    host: ${REDIS_HOST:localhost}
    port: ${REDIS_PORT:6379}
    password: ${REDIS_PASSWORD:}
    database: ${REDIS_DATABASE:0}

# Feigné…ç½®
feign:
  client:
    config:
      service-auth:
        connect-timeout: 5000
        read-timeout: 10000
      aliyun-oss:
        connect-timeout: 10000
        read-timeout: 30000

# æ–‡ä»¶ä¸Šä¼ é…ç½®
file:
  upload:
    max-size: 10MB
    allowed-types: jpg,jpeg,png,gif
    avatar-path: /avatars/
```

### ç¯å¢ƒé…ç½®
- **å¼€å‘ç¯å¢ƒ**: `application-dev.yml`
- **æµ‹è¯•ç¯å¢ƒ**: `application-test.yml`
- **ç”Ÿäº§ç¯å¢ƒ**: `application-prod.yml`

## ğŸ”„ ä¸šåŠ¡æµç¨‹

### 1. ç”¨æˆ·åˆ›å»ºæµç¨‹
```
1. æ¥æ”¶ç”¨æˆ·åˆ›å»ºè¯·æ±‚
   â†“
2. éªŒè¯ç”¨æˆ·ä¿¡æ¯
   â†“
3. è°ƒç”¨è®¤è¯æœåŠ¡åŠ å¯†å¯†ç 
   â†“
4. ä¸Šä¼ å¤´åƒåˆ°OSSï¼ˆå¦‚æœæœ‰ï¼‰
   â†“
5. ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°æ•°æ®åº“
   â†“
6. è¿”å›ç”¨æˆ·ä¿¡æ¯
```

### 2. ç”¨æˆ·ä¿¡æ¯æ›´æ–°æµç¨‹
```
1. æ¥æ”¶ç”¨æˆ·æ›´æ–°è¯·æ±‚
   â†“
2. éªŒè¯ç”¨æˆ·æƒé™
   â†“
3. æ›´æ–°å¤´åƒï¼ˆå¦‚æœæœ‰ï¼‰
   â†“
4. æ›´æ–°ç”¨æˆ·ä¿¡æ¯
   â†“
5. è®°å½•æ“ä½œæ—¥å¿—
   â†“
6. è¿”å›æ›´æ–°ç»“æœ
```

### 3. ç”¨æˆ·æŸ¥è¯¢æµç¨‹
```
1. æ¥æ”¶æŸ¥è¯¢è¯·æ±‚
   â†“
2. éªŒè¯æŸ¥è¯¢æƒé™
   â†“
3. æ„å»ºæŸ¥è¯¢æ¡ä»¶
   â†“
4. æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢
   â†“
5. å¤„ç†æŸ¥è¯¢ç»“æœ
   â†“
6. è¿”å›æŸ¥è¯¢ç»“æœ
```

## ğŸš¨ å¼‚å¸¸å¤„ç†ä¸é”™è¯¯ç 

### 1. å¼‚å¸¸å¤„ç†æœºåˆ¶
- **ç»Ÿä¸€å¼‚å¸¸å¤„ç†**: ä½¿ç”¨`UserExceptionHandler`ç»Ÿä¸€å¤„ç†å¼‚å¸¸
- **ä¸šåŠ¡å¼‚å¸¸**: ä½¿ç”¨`BusinessException`å¤„ç†ä¸šåŠ¡é€»è¾‘å¼‚å¸¸
- **ç³»ç»Ÿå¼‚å¸¸**: ä½¿ç”¨`GlobalExceptionHandler`å¤„ç†ç³»ç»Ÿå¼‚å¸¸
- **å‚æ•°éªŒè¯**: ä½¿ç”¨`@Valid`å’Œ`@Validated`è¿›è¡Œå‚æ•°éªŒè¯

### 2. é”™è¯¯ç å®šä¹‰

#### åŸºç¡€é”™è¯¯ç 
| é”™è¯¯ç  | é”™è¯¯ç±»å‹ | é”™è¯¯æè¿° |
|--------|----------|----------|
| 400 | å‚æ•°é”™è¯¯ | è¯·æ±‚å‚æ•°ä¸æ­£ç¡® |
| 401 | æœªæˆæƒ | ç”¨æˆ·æœªç™»å½•æˆ–è®¤è¯å¤±è´¥ |
| 403 | ç¦æ­¢è®¿é—® | ç”¨æˆ·æƒé™ä¸è¶³ |
| 404 | èµ„æºä¸å­˜åœ¨ | è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨ |
| 409 | çŠ¶æ€å†²çª | èµ„æºçŠ¶æ€ä¸å…è®¸æ“ä½œ |
| 500 | ç³»ç»Ÿé”™è¯¯ | ç³»ç»Ÿå†…éƒ¨é”™è¯¯ |

#### ç”¨æˆ·ç®¡ç†ç›¸å…³é”™è¯¯ç 
| é”™è¯¯ç  | é”™è¯¯ç±»å‹ | é”™è¯¯æè¿° |
|--------|----------|----------|
| 1001 | ç”¨æˆ·ä¸å­˜åœ¨ | æŒ‡å®šçš„ç”¨æˆ·ä¸å­˜åœ¨ |
| 1002 | ç”¨æˆ·å·²å­˜åœ¨ | ç”¨æˆ·åæˆ–æ‰‹æœºå·å·²å­˜åœ¨ |
| 1003 | å¯†ç é”™è¯¯ | ç”¨æˆ·å¯†ç é”™è¯¯ |
| 1004 | è´¦å·å·²è¢«ç¦ç”¨ | ç”¨æˆ·è´¦å·å·²è¢«ç¦ç”¨ |
| 1005 | ä»¤ç‰Œå·²è¿‡æœŸ | JWTä»¤ç‰Œå·²è¿‡æœŸ |
| 1006 | ä»¤ç‰Œæ— æ•ˆ | JWTä»¤ç‰Œæ— æ•ˆ |
| 1007 | ç”¨æˆ·æ¡£æ¡ˆä¸å­˜åœ¨ | ç”¨æˆ·æ¡£æ¡ˆä¿¡æ¯ä¸å­˜åœ¨ |
| 1008 | ç”¨æˆ·å¤´åƒä¸Šä¼ å¤±è´¥ | ç”¨æˆ·å¤´åƒä¸Šä¼ æ“ä½œå¤±è´¥ |
| 1009 | ç”¨æˆ·æƒé™ä¸è¶³ | ç”¨æˆ·æƒé™ä¸è¶³ä»¥æ‰§è¡Œæ“ä½œ |

#### æ–‡ä»¶ç›¸å…³é”™è¯¯ç 
| é”™è¯¯ç  | é”™è¯¯ç±»å‹ | é”™è¯¯æè¿° |
|--------|----------|----------|
| 4109 | OSSæ–‡ä»¶ä¸Šä¼ å¤±è´¥ | OSSæ–‡ä»¶ä¸Šä¼ æ“ä½œå¤±è´¥ |
| 4110 | OSSæ–‡ä»¶ä¸å­˜åœ¨ | OSSæŒ‡å®šçš„æ–‡ä»¶ä¸å­˜åœ¨ |
| 4111 | OSSæ–‡ä»¶å¤§å°è¶…é™ | OSSæ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶ |
| 4112 | OSSæ–‡ä»¶ç±»å‹ä¸å…è®¸ | OSSä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹ |

### 3. å¼‚å¸¸å¤„ç†æµç¨‹
```
1. å¼‚å¸¸å‘ç”Ÿ
   â†“
2. å¼‚å¸¸æ‹¦æˆªå™¨æ•è·
   â†“
3. å¼‚å¸¸åˆ†ç±»å¤„ç†
   â†“
4. é”™è¯¯ç æ˜ å°„
   â†“
5. é”™è¯¯ä¿¡æ¯æ ¼å¼åŒ–
   â†“
6. è¿”å›ç»Ÿä¸€é”™è¯¯å“åº”
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### 1. ç¼“å­˜ç­–ç•¥
- **Redisç¼“å­˜**: ç”¨æˆ·ä¿¡æ¯ç¼“å­˜ï¼Œå‡å°‘æ•°æ®åº“æŸ¥è¯¢
- **å¤´åƒç¼“å­˜**: å¤´åƒURLç¼“å­˜ï¼Œæé«˜è®¿é—®é€Ÿåº¦
- **æŸ¥è¯¢ç¼“å­˜**: ç”¨æˆ·åˆ—è¡¨æŸ¥è¯¢ç»“æœç¼“å­˜
- **ç¼“å­˜è¿‡æœŸ**: åˆç†çš„ç¼“å­˜è¿‡æœŸæ—¶é—´è®¾ç½®

### 2. æ•°æ®åº“ä¼˜åŒ–
- **ç´¢å¼•ä¼˜åŒ–**: ç”¨æˆ·åã€é‚®ç®±ã€æ‰‹æœºå·ç­‰å­—æ®µåˆ›å»ºç´¢å¼•
- **æŸ¥è¯¢ä¼˜åŒ–**: ä½¿ç”¨MyBatis Plusä¼˜åŒ–æŸ¥è¯¢
- **è¿æ¥æ± **: é…ç½®åˆé€‚çš„æ•°æ®åº“è¿æ¥æ± 
- **åˆ†é¡µæŸ¥è¯¢**: ç”¨æˆ·åˆ—è¡¨ä½¿ç”¨åˆ†é¡µæŸ¥è¯¢

### 3. æ¥å£ä¼˜åŒ–
- **å¼‚æ­¥å¤„ç†**: å¤´åƒä¸Šä¼ ä½¿ç”¨å¼‚æ­¥å¤„ç†
- **æ‰¹é‡æ“ä½œ**: æ‰¹é‡åˆ é™¤ç”¨æˆ·æ“ä½œ
- **é™æµä¿æŠ¤**: é«˜é¢‘æ¥å£é™æµä¿æŠ¤
- **å“åº”ä¼˜åŒ–**: åˆç†è®¾ç½®å“åº”æ•°æ®å¤§å°

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### 1. å•å…ƒæµ‹è¯•
- **Serviceå±‚æµ‹è¯•**: æµ‹è¯•ç”¨æˆ·ä¸šåŠ¡é€»è¾‘
- **Feignå®¢æˆ·ç«¯æµ‹è¯•**: æµ‹è¯•å¤–éƒ¨æœåŠ¡è°ƒç”¨
- **Mapperå±‚æµ‹è¯•**: æµ‹è¯•æ•°æ®è®¿é—®å±‚

### 2. é›†æˆæµ‹è¯•
- **APIæµ‹è¯•**: æµ‹è¯•RESTæ¥å£åŠŸèƒ½
- **æ•°æ®åº“æµ‹è¯•**: æµ‹è¯•æ•°æ®åº“æ“ä½œ
- **Feignæµ‹è¯•**: æµ‹è¯•å¤–éƒ¨æœåŠ¡é›†æˆ

### 3. æ€§èƒ½æµ‹è¯•
- **å¹¶å‘æµ‹è¯•**: æµ‹è¯•å¹¶å‘ç”¨æˆ·æ“ä½œæ€§èƒ½
- **å‹åŠ›æµ‹è¯•**: æµ‹è¯•ç³»ç»Ÿæ‰¿è½½èƒ½åŠ›
- **ç¨³å®šæ€§æµ‹è¯•**: æµ‹è¯•é•¿æœŸè¿è¡Œç¨³å®šæ€§

## ğŸ“ˆ ç›‘æ§æŒ‡æ ‡

### 1. ä¸šåŠ¡æŒ‡æ ‡
- **ç”¨æˆ·åˆ›å»ºæˆåŠŸç‡**: ç”¨æˆ·åˆ›å»ºæˆåŠŸæ¬¡æ•°/æ€»åˆ›å»ºæ¬¡æ•°
- **ç”¨æˆ·æŸ¥è¯¢å“åº”æ—¶é—´**: ç”¨æˆ·æŸ¥è¯¢æ¥å£å¹³å‡å“åº”æ—¶é—´
- **å¤´åƒä¸Šä¼ æˆåŠŸç‡**: å¤´åƒä¸Šä¼ æˆåŠŸæ¬¡æ•°/æ€»ä¸Šä¼ æ¬¡æ•°
- **æ´»è·ƒç”¨æˆ·æ•°**: å½“å‰æ´»è·ƒç”¨æˆ·æ•°é‡

### 2. æŠ€æœ¯æŒ‡æ ‡
- **æ¥å£å“åº”æ—¶é—´**: å„æ¥å£å¹³å‡å“åº”æ—¶é—´
- **é”™è¯¯ç‡**: æ¥å£é”™è¯¯ç‡ç»Ÿè®¡
- **ç¼“å­˜å‘½ä¸­ç‡**: Redisç¼“å­˜å‘½ä¸­ç‡
- **æ•°æ®åº“è¿æ¥æ•°**: æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨æƒ…å†µ

### 3. å¤–éƒ¨æœåŠ¡æŒ‡æ ‡
- **è®¤è¯æœåŠ¡è°ƒç”¨æˆåŠŸç‡**: AuthæœåŠ¡è°ƒç”¨æˆåŠŸæ¬¡æ•°/æ€»è°ƒç”¨æ¬¡æ•°
- **OSSæœåŠ¡å“åº”æ—¶é—´**: æ–‡ä»¶ä¸Šä¼ çš„å¹³å‡å“åº”æ—¶é—´
- **Feigné™çº§æ¬¡æ•°**: å¤–éƒ¨æœåŠ¡ä¸å¯ç”¨æ—¶çš„é™çº§å¤„ç†æ¬¡æ•°

## ğŸ”® æ‰©å±•è§„åˆ’

### 1. åŠŸèƒ½æ‰©å±•
- **ç”¨æˆ·æ¡£æ¡ˆç®¡ç†**: æ‰©å±•ç”¨æˆ·æ¡£æ¡ˆä¿¡æ¯
- **ç”¨æˆ·æ ‡ç­¾ç³»ç»Ÿ**: æ”¯æŒç”¨æˆ·æ ‡ç­¾ç®¡ç†
- **ç”¨æˆ·åˆ†ç»„ç®¡ç†**: æ”¯æŒç”¨æˆ·åˆ†ç»„åŠŸèƒ½
- **ç”¨æˆ·è¡Œä¸ºåˆ†æ**: ç”¨æˆ·è¡Œä¸ºæ•°æ®æ”¶é›†å’Œåˆ†æ

### 2. æ€§èƒ½ä¼˜åŒ–
- **åˆ†å¸ƒå¼ç¼“å­˜**: ä½¿ç”¨Redisé›†ç¾¤
- **æ•°æ®åº“åˆ†åº“åˆ†è¡¨**: æ”¯æŒå¤§è§„æ¨¡ç”¨æˆ·
- **CDNåŠ é€Ÿ**: å¤´åƒæ–‡ä»¶CDNåŠ é€Ÿ
- **å¼‚æ­¥å¤„ç†**: æ›´å¤šå¼‚æ­¥å¤„ç†åœºæ™¯

### 3. æ¶æ„å‡çº§
- **æœåŠ¡ç½‘æ ¼**: é›†æˆIstioæœåŠ¡ç½‘æ ¼
- **å®¹å™¨åŒ–éƒ¨ç½²**: æ”¯æŒKuberneteséƒ¨ç½²
- **ç›‘æ§å‘Šè­¦**: å®Œå–„ç›‘æ§å‘Šè­¦ä½“ç³»
- **è‡ªåŠ¨åŒ–è¿ç»´**: å®ç°è‡ªåŠ¨åŒ–è¿ç»´

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2025-01-27  
**ç»´æŠ¤äººå‘˜**: scccy 