# 新建模块工作流程

> **文档位置**: `zinfra/moudleDocs/新建模块工作流程.md`
> **创建时间**: 2025-08-01
> **作者**: scccy

## 1. 工作流程概述

### 1.1 流程框架
本工作流程包含两套框架：
- **第一套框架**: 完整模块开发流程 - 适用于新建模块
- **第二套框架**: 模块迭代流程 - 适用于已有模块的功能扩展

### 1.2 流程原则
- **文档驱动**: 所有开发工作都基于文档进行
- **用户确认**: 每个关键步骤都需要用户确认
- **迭代优化**: 支持多次迭代和优化
- **标准化**: 遵循统一的文档和代码规范

## 2. 第一套框架：完整模块开发流程

### 2.1 流程概述
适用于从零开始新建微服务模块的完整开发流程。

### 2.2 详细步骤

#### 步骤1：生成文件夹及模块主体讨论
**目标**: 创建模块文档结构，明确模块需求和功能范围

**具体操作**:
1. 在 `zinfra/moudleDocs/` 下创建模块文件夹
   ```bash
   mkdir zinfra/moudleDocs/{模块名称}
   ```

2. 创建模块主体讨论文档
   ```bash
   touch zinfra/moudleDocs/{模块名称}/模块主体讨论.md
   ```

3. 用户描述模块需求和功能范围
   - 模块背景和目标
   - 核心功能需求
   - 技术选型要求
   - 与其他模块的交互

**输出成果**:
- 模块文件夹结构
- 模块主体讨论.md 文档

**用户确认点**: 模块需求是否完整、准确

#### 步骤2：功能拆分与模块确认
**目标**: AI总结主题内容，生成功能拆分建议，用户确认

**具体操作**:
1. AI分析模块主体讨论内容
2. 将需求拆分为具体的功能模块
3. 生成功能拆分建议文档
4. 用户确认功能拆分方案

**功能拆分维度**:
- **业务功能**: 核心业务逻辑功能
- **管理功能**: 后台管理功能
- **接口功能**: 对外提供的API接口
- **集成功能**: 与其他系统的集成功能

**输出成果**:
- 功能拆分建议文档
- 确认后的功能模块列表

**用户确认点**: 功能拆分是否合理、完整

#### 步骤3：设计模板生成
**目标**: 基于确认的功能拆分生成设计模板

**具体操作**:
1. 基于功能拆分生成模块设计文档
2. 设计数据库表结构
3. 设计API接口规范
4. 设计业务逻辑流程
5. **填写核心注意事项** - 明确关键约束、特殊要求、风险提示、依赖关系
6. 用户确认设计模板

**设计内容**:
- 核心注意事项（关键约束、特殊要求、风险提示、依赖关系）
- 模块架构设计
- 数据库设计
- API接口设计
- 业务逻辑设计
- 安全设计
- 性能设计

**输出成果**:
- 模块设计.md 文档
- 数据库建表脚本
- API接口设计文档

**用户确认点**: 设计是否满足需求、技术方案是否可行

#### 步骤4：API接口文档生成
**目标**: 基于设计模板生成API接口文档

**具体操作**:
1. 基于模块设计生成API接口说明文档
2. 详细设计每个API接口
3. 定义请求参数和响应格式
4. 标识哪些接口需要提供Feign客户端
5. 生成API接口测试文档
6. 用户确认API接口设计

**API设计内容**:
- 接口规范定义
- 接口列表和分类（包含Feign客户端标识）
- 每个接口的详细说明
- 请求参数和响应格式
- 错误码定义
- 接口测试用例
- Feign客户端使用示例

**输出成果**:
- API接口说明.md 文档
- API接口测试.md 文档

**用户确认点**: API接口设计是否完整、规范

#### 步骤5：微服务开发
**目标**: 按照模块设计开始开发对应的微服务

**具体操作**:
1. 创建微服务项目结构
2. 实现数据库表结构
3. 实现实体类和DTO
4. 实现Service层业务逻辑
5. 实现Controller层API接口
6. 实现Feign客户端
7. 配置和测试

**开发内容**:
- 项目结构搭建
- 数据库表创建
- 实体类和DTO实现
- Service层实现
- Controller层实现
- Feign客户端实现
- 配置文件编写
- 单元测试编写

**输出成果**:
- 完整的微服务代码
- 可运行的微服务应用
- 测试通过的API接口

**用户确认点**: 功能是否按设计实现、测试是否通过

### 2.3 流程示例：第三方-微信模块

#### 示例场景
用户需求：新建第三方-微信模块，需要调用微信朋友圈的相关功能，并使用Feign客户端给其他微服务使用。

#### 执行流程
1. **生成文件夹及模块主体讨论**
   - 创建 `zinfra/moudleDocs/third-party-wechat/` 文件夹
   - 创建 `模块主体讨论.md` 文档
   - 用户描述：需要调用微信朋友圈功能，提供Feign客户端

2. **功能拆分与模块确认**
   - AI分析：微信朋友圈功能、Feign客户端、用户管理、内容管理
   - 用户确认：功能拆分合理

3. **设计模板生成**
   - 生成微信模块设计文档
   - 设计微信用户表、朋友圈内容表
   - 设计微信API接口
   - 用户确认设计

4. **API接口文档生成**
   - 生成微信API接口说明文档
   - 设计朋友圈发布、查询、点赞等接口
   - 生成API测试文档
   - 用户确认接口设计

5. **微服务开发**
   - 创建 `third-party-wechat` 微服务
   - 实现微信相关功能
   - 实现Feign客户端
   - 测试验证

## 3. 第二套框架：模块迭代流程

### 3.1 流程概述
适用于已有模块进行功能扩展和迭代的开发流程。

### 3.2 详细步骤

#### 步骤1：生成迭代模板
**目标**: 创建迭代模板文档，支持多次迭代

**具体操作**:
1. 创建迭代模板文档
   ```bash
   touch zinfra/moudleDocs/{模块名称}/模块迭代说明_YYYYMMDD_迭代描述.md
   ```

2. 用户描述迭代需求和功能扩展
3. 记录迭代版本和时间信息

**迭代模板内容**:
- 迭代版本信息
- 迭代目标和范围
- 新增需求描述
- 优化需求描述
- 修复需求描述

**输出成果**:
- 迭代模板文档
- 迭代需求清单

**用户确认点**: 迭代需求是否明确、合理

#### 步骤2：功能拆分与确认
**目标**: AI分析迭代主题内容，将主题拆分成多个接口和功能点

**具体操作**:
1. AI分析迭代需求内容
2. 将需求拆分为具体的功能点
3. 识别新增的接口需求
4. 分析对现有功能的影响
5. 用户确认功能拆分方案

**功能拆分维度**:
- **新增功能**: 完全新增的功能模块
- **优化功能**: 对现有功能的优化改进
- **修复功能**: 问题修复和bug修复
- **集成功能**: 与其他系统的集成

**输出成果**:
- 迭代功能拆分文档
- 确认后的功能点列表

**用户确认点**: 功能拆分是否准确、影响范围是否合理

#### 步骤3：迭代设计生成
**目标**: 基于确认的功能拆分生成迭代设计文件

**具体操作**:
1. 基于功能拆分生成迭代设计文档
2. 设计新增的数据库表结构
3. 设计新增的API接口
4. 设计业务逻辑变更
5. 用户确认迭代设计方案

**迭代设计内容**:
- 新增功能设计
- 数据库变更设计
- API接口变更设计
- 业务逻辑变更设计
- 兼容性设计

**输出成果**:
- 模块迭代设计.md 文档
- 数据库变更脚本
- API接口变更文档

**用户确认点**: 迭代设计是否满足需求、变更是否合理

#### 步骤4：迭代开发
**目标**: 按照迭代设计进行开发

**具体操作**:
1. 实现新增的数据库表结构
2. 实现新增的API接口
3. 实现业务逻辑变更
4. 实现Feign客户端更新
5. 测试验证新功能

**开发内容**:
- 数据库表变更
- 实体类和DTO更新
- Service层功能扩展
- Controller层接口扩展
- Feign客户端更新
- 配置文件更新
- 测试用例编写

**输出成果**:
- 更新的微服务代码
- 新增的功能模块
- 测试通过的新功能

**用户确认点**: 新功能是否按设计实现、测试是否通过

#### 步骤5：文档更新
**目标**: 更新设计模板、API接口、测试文档

**具体操作**:
1. 更新模块设计文档
2. 更新API接口说明文档
3. 更新API接口测试文档
4. 更新模块迭代说明文档
5. 更新相关技术文档

**文档更新内容**:
- 设计文档版本更新
- API接口文档更新
- 测试文档更新
- 迭代记录更新
- 技术文档同步

**输出成果**:
- 更新的设计文档
- 更新的API文档
- 更新的测试文档
- 完整的迭代记录

**用户确认点**: 文档是否与代码实现一致、是否完整准确

### 3.3 流程示例：微信模块迭代

#### 示例场景
用户需求：微信模块需要迭代，新增调用微信头像保存功能，供其他服务使用。

#### 执行流程
1. **生成迭代模板**
   - 创建 `模块迭代说明_20250801_头像功能扩展.md`
   - 用户描述：需要新增微信头像保存功能

2. **功能拆分与确认**
   - AI分析：头像获取、头像保存、头像同步、Feign客户端扩展
   - 用户确认：功能拆分合理

3. **迭代设计生成**
   - 生成头像功能迭代设计文档
   - 设计头像相关表结构
   - 设计头像相关API接口
   - 用户确认迭代设计

4. **迭代开发**
   - 实现头像获取和保存功能
   - 实现头像同步功能
   - 扩展Feign客户端
   - 测试验证新功能

5. **文档更新**
   - 更新微信模块设计文档
   - 更新API接口说明文档
   - 更新API接口测试文档
   - 更新迭代说明文档

## 4. 工作流程管理

### 4.1 流程控制
- **阶段确认**: 每个步骤完成后需要用户确认
- **文档同步**: 所有变更都要同步更新相关文档
- **版本控制**: 重要变更需要版本标记
- **质量保证**: 每个阶段都要进行质量检查

### 4.2 文档管理
- **文档模板**: 使用标准化的文档模板
- **文档更新**: 及时更新相关文档
- **文档评审**: 重要文档需要团队评审
- **文档归档**: 完成后的文档进行归档管理

### 4.3 质量保证
- **代码审查**: 所有代码必须经过审查
- **测试验证**: 每个功能都要进行测试验证
- **文档检查**: 确保文档与代码实现一致
- **性能测试**: 重要功能要进行性能测试

## 5. 总结

本新建模块工作流程提供了：
- 完整的新建模块开发流程
- 标准的模块迭代流程
- 详细的步骤说明和操作指导
- 完善的文档管理和质量保证机制

所有模块开发都应遵循本工作流程，确保开发过程的规范性和一致性。 