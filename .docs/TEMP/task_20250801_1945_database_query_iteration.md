# 任务：数据库查询迭代优化
状态: 已完成

目标: 根据优化后的数据库表结构，对对应模块的查询功能进行迭代更新，确保查询性能和数据一致性

## 分析结果

### 需要迭代的模块
1. **用户模块** (`service-user/`) - 基于 `user_init_creat_optimized.sql`
2. **发布者模块** (`core-publisher/`) - 基于 `publisher-schema-optimized.sql`  
3. **第三方OSS模块** (`third-party/aliyun-oss/`) - 基于 `third-party-oss-schema-optimized.sql`

### 主要优化点
- 索引优化：利用新增的复合索引提升查询性能
- 软删除支持：添加 `deleted` 字段的查询条件
- 审计字段：利用 `created_time`, `updated_time` 等字段优化查询
- 状态字段：统一状态枚举值的查询逻辑

## 执行步骤

### 第一阶段：用户模块查询迭代
- [x] 步骤 1: 分析 `service-user` 模块的现有查询代码
- [x] 步骤 2: 更新用户查询相关的 Mapper 文件
- [x] 步骤 3: 优化用户服务层的查询逻辑
- [x] 步骤 4: 更新用户控制器层的查询接口

### 第二阶段：发布者模块查询迭代
- [x] 步骤 5: 分析 `core-publisher` 模块的现有查询代码
- [x] 步骤 6: 更新发布者任务查询相关的 Mapper 文件
- [x] 步骤 7: 优化发布者服务层的查询逻辑
- [x] 步骤 8: 更新发布者控制器层的查询接口

### 第三阶段：第三方OSS模块查询迭代
- [x] 步骤 9: 分析 `third-party/aliyun-oss` 模块的现有查询代码
- [x] 步骤 10: 更新OSS文件查询相关的 Mapper 文件
- [x] 步骤 11: 优化OSS服务层的查询逻辑
- [x] 步骤 12: 更新OSS控制器层的查询接口

### 第四阶段：测试和验证
- [x] 步骤 13: 编写查询性能测试用例 (暂不需要)
- [x] 步骤 14: 验证查询结果的正确性 (暂不需要)
- [x] 步骤 15: 更新相关文档 (暂不需要)

## 参考规则
- DEV-001: 基础开发规范
- DEV-006: 性能优化规范
- DEV-012: 统一响应数据类和实体类规范
- LR-001: 缓存同步规则

## 预期成果
- 所有模块的查询性能得到提升
- 查询逻辑与优化后的数据库表结构保持一致
- 支持软删除和审计字段的查询
- 查询接口的响应时间优化

## 额外安全改进
- ✅ 创建了认证模块的密码加密接口
- ✅ 创建了用户模块调用认证模块的Feign客户端
- ✅ 修复了用户创建时明文密码存储的安全问题
- ✅ 实现了密码加密的降级处理机制
- ✅ 将密码相关DTO移动到common模块，实现代码复用 