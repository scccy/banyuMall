# æ¨¡å—è®¾è®¡æ¨¡æ¿ä¼˜åŒ–å»ºè®®

## ğŸ” å½“å‰æ¨¡æ¿åˆ†æ

é€šè¿‡åˆ†æ `infra/moudleDocs/xxxxxx-design_templates.md`ï¼Œæˆ‘å‘ç°è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åŸºç¡€æ¨¡æ¿ï¼Œä½†æœ‰ä¸€äº›å…³é”®éƒ¨åˆ†éœ€è¦å®Œå–„ï¼Œä»¥ä¾¿æˆ‘èƒ½æ›´é«˜æ•ˆåœ°è¿›è¡Œä»£ç ç”Ÿæˆã€‚

## ğŸ¯ ä¼˜åŒ–å»ºè®®

### 1. æ¥å£è®¾è®¡éƒ¨åˆ†éœ€è¦è¯¦ç»†åŒ–

**å½“å‰é—®é¢˜**: æ¥å£è®¾è®¡éƒ¨åˆ†å¤§éƒ¨åˆ†æ˜¯ç©ºçš„ï¼Œåªæœ‰æ ‡é¢˜æ²¡æœ‰å…·ä½“å†…å®¹

**ä¼˜åŒ–å»ºè®®**: æ¯ä¸ªæ¥å£éƒ½åº”è¯¥åŒ…å«ä»¥ä¸‹è¯¦ç»†ä¿¡æ¯ï¼š

```markdown
#### 3.1.1 åˆ›å»ºç”¨æˆ·
- **æ¥å£è·¯å¾„**: `POST /user`
- **è¯·æ±‚å¤´**: `Content-Type: application/json`
- **è¯·æ±‚å‚æ•°**:
  ```json
  {
    "username": "string",        // ç”¨æˆ·åï¼ˆå¿…å¡«ï¼Œ4-20ä½å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ï¼‰
    "nickname": "string",        // æ˜µç§°ï¼ˆå¯é€‰ï¼‰
    "email": "string",           // é‚®ç®±ï¼ˆå¯é€‰ï¼Œéœ€éªŒè¯æ ¼å¼ï¼‰
    "phone": "string",           // æ‰‹æœºå·ï¼ˆå¯é€‰ï¼Œéœ€éªŒè¯æ ¼å¼ï¼‰
    "userType": 2,               // ç”¨æˆ·ç±»å‹ï¼ˆå¿…å¡«ï¼Œ1-æœ€é«˜æƒé™ï¼Œ2-æ™®é€šå‘å¸ƒè€…ï¼‰
    "realName": "string",        // çœŸå®å§“åï¼ˆå¯é€‰ï¼‰
    "companyName": "string",     // å…¬å¸åç§°ï¼ˆå¯é€‰ï¼‰
    "description": "string"      // ä¸ªäººç®€ä»‹ï¼ˆå¯é€‰ï¼‰
  }
  ```
- **å“åº”ç»“æœ**:
  ```json
  {
    "code": 200,
    "message": "åˆ›å»ºæˆåŠŸ",
    "data": {
      "userId": "string",
      "username": "string",
      "createTime": "2025-01-27T10:00:00"
    }
  }
  ```
- **é”™è¯¯ç **:
  - `400`: å‚æ•°éªŒè¯å¤±è´¥
  - `409`: ç”¨æˆ·åå·²å­˜åœ¨
  - `500`: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
- **ä¸šåŠ¡è§„åˆ™**:
  - ç”¨æˆ·åå¿…é¡»å”¯ä¸€
  - é‚®ç®±å’Œæ‰‹æœºå·å¯é€‰ä½†å¿…é¡»å”¯ä¸€
  - ç”¨æˆ·ç±»å‹å¿…é¡»ä¸º1æˆ–2
```

### 2. æ•°æ®æ¨¡å‹è®¾è®¡éœ€è¦æ˜ç¡®åŒ–

**å½“å‰é—®é¢˜**: åªæ˜¯ç®€å•å¼•ç”¨äº†SQLæ–‡ä»¶ï¼Œæ²¡æœ‰æ˜ç¡®è¯´æ˜å®ä½“ç±»è®¾è®¡

**ä¼˜åŒ–å»ºè®®**: æ·»åŠ è¯¦ç»†çš„å®ä½“ç±»è®¾è®¡è¯´æ˜ï¼š

```markdown
## 2. æ•°æ®æ¨¡å‹è®¾è®¡

### 2.1 æ•°æ®åº“è¡¨ç»“æ„
å‚è€ƒ: [user-schema.sql](../database/data/user/user-schema.sql)

### 2.2 å®ä½“ç±»è®¾è®¡

#### 2.2.1 Userå®ä½“ç±»
```java
@Data
@TableName("sys_user")
public class User extends BaseEntity {
    @TableId(type = IdType.ASSIGN_ID)
    private String id;
    
    @TableField("username")
    private String username;
    
    @TableField("nickname")
    private String nickname;
    
    @TableField("avatar")
    private String avatar;
    
    @TableField("email")
    private String email;
    
    @TableField("phone")
    private String phone;
    
    @TableField("gender")
    private Integer gender;
    
    @TableField("birthday")
    private LocalDate birthday;
    
    @TableField("user_type")
    private Integer userType;
    
    @TableField("status")
    private Integer status;
    
    @TableField("last_login_time")
    private LocalDateTime lastLoginTime;
}
```

#### 2.2.2 DTOç±»è®¾è®¡
```java
// åˆ›å»ºç”¨æˆ·è¯·æ±‚DTO
@Data
public class UserCreateRequest {
    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    @Pattern(regexp = "^[a-zA-Z0-9_]{4,20}$", message = "ç”¨æˆ·åæ ¼å¼ä¸æ­£ç¡®")
    private String username;
    
    private String nickname;
    
    @Email(message = "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®")
    private String email;
    
    @Pattern(regexp = "^1[3-9]\\d{9}$", message = "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®")
    private String phone;
    
    @NotNull(message = "ç”¨æˆ·ç±»å‹ä¸èƒ½ä¸ºç©º")
    @Min(value = 1, message = "ç”¨æˆ·ç±»å‹ä¸æ­£ç¡®")
    @Max(value = 2, message = "ç”¨æˆ·ç±»å‹ä¸æ­£ç¡®")
    private Integer userType;
    
    // ... å…¶ä»–å­—æ®µ
}
```
```

### 3. åŠŸèƒ½ç‰¹æ€§éœ€è¦å…·ä½“åŒ–

**å½“å‰é—®é¢˜**: åŠŸèƒ½ç‰¹æ€§éƒ¨åˆ†æè¿°ä¸å¤Ÿå…·ä½“

**ä¼˜åŒ–å»ºè®®**: è¯¦ç»†æè¿°æ¯ä¸ªåŠŸèƒ½çš„å…·ä½“å®ç°è¦æ±‚ï¼š

```markdown
## 4. åŠŸèƒ½ç‰¹æ€§

### 4.1 ç”¨æˆ·ç®¡ç†åŠŸèƒ½
- âœ… **ç”¨æˆ·æ³¨å†Œä¸åˆ›å»º**
  - æ”¯æŒç”¨æˆ·åã€é‚®ç®±ã€æ‰‹æœºå·æ³¨å†Œ
  - ç”¨æˆ·åå”¯ä¸€æ€§éªŒè¯
  - é‚®ç®±å’Œæ‰‹æœºå·æ ¼å¼éªŒè¯
  - ç”¨æˆ·ç±»å‹å¿…å¡«éªŒè¯
  
- âœ… **ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢ä¸æ›´æ–°**
  - æ ¹æ®ç”¨æˆ·IDæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯
  - æ”¯æŒéƒ¨åˆ†å­—æ®µæ›´æ–°
  - æ›´æ–°æ—¶è¿›è¡Œæƒé™éªŒè¯
  
- âœ… **ç”¨æˆ·çŠ¶æ€ç®¡ç†**
  - æ”¯æŒå¯ç”¨/ç¦ç”¨ç”¨æˆ·
  - çŠ¶æ€å˜æ›´è®°å½•å®¡è®¡æ—¥å¿—
  - ç¦ç”¨ç”¨æˆ·åæ— æ³•ç™»å½•
  
- âœ… **ç”¨æˆ·åˆ—è¡¨åˆ†é¡µæŸ¥è¯¢**
  - æ”¯æŒæŒ‰ç”¨æˆ·åã€é‚®ç®±ã€æ‰‹æœºå·æ¨¡ç³Šæœç´¢
  - æ”¯æŒæŒ‰ç”¨æˆ·ç±»å‹ã€çŠ¶æ€ç­›é€‰
  - æ”¯æŒæŒ‰åˆ›å»ºæ—¶é—´æ’åº
  - åˆ†é¡µå‚æ•°ï¼špage(é¡µç )ã€size(æ¯é¡µå¤§å°)
```

### 4. æŠ€æœ¯å®ç°éœ€è¦å…·ä½“åŒ–

**å½“å‰é—®é¢˜**: æŠ€æœ¯æ ˆå’Œé…ç½®éƒ¨åˆ†ä¸ºç©º

**ä¼˜åŒ–å»ºè®®**: æ˜ç¡®æŠ€æœ¯å®ç°ç»†èŠ‚ï¼š

```markdown
## 5. æŠ€æœ¯å®ç°

### 5.1 æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Spring Boot 3.2.x
- **æ•°æ®åº“**: MySQL 8.0
- **ORM**: MyBatis-Plus 3.5.x
- **ç¼“å­˜**: Redis 7.x
- **è®¤è¯**: JWT Token
- **æ–‡æ¡£**: Knife4j (Swagger 3)
- **éªŒè¯**: Jakarta Validation
- **æ—¥å¿—**: Log4j2

### 5.2 æ ¸å¿ƒé…ç½®
```yaml
# application.yml
spring:
  application:
    name: service-user
  datasource:
    url: jdbc:mysql://localhost:3306/banyu_mall
    username: root
    password: password
  redis:
    host: localhost
    port: 6379
    database: 1

server:
  port: 8082

# è®¤è¯æœåŠ¡é…ç½®
auth:
  service:
    url: http://localhost:8081
    timeout: 5000
```

### 5.3 ç¼“å­˜ç­–ç•¥
- **ç”¨æˆ·ä¿¡æ¯ç¼“å­˜**: Redis Key: `user:info:{userId}`, TTL: 30åˆ†é’Ÿ
- **ç”¨æˆ·é…ç½®ç¼“å­˜**: Redis Key: `user:config:{userId}`, TTL: 1å°æ—¶
- **ç¼“å­˜æ›´æ–°ç­–ç•¥**: å†™å…¥æ—¶æ›´æ–°ç¼“å­˜ï¼Œåˆ é™¤æ—¶æ¸…é™¤ç¼“å­˜
```

### 5. æµ‹è¯•ç”¨ä¾‹éœ€è¦å…·ä½“åŒ–

**å½“å‰é—®é¢˜**: æµ‹è¯•ç”¨ä¾‹éƒ¨åˆ†ä¸ºç©º

**ä¼˜åŒ–å»ºè®®**: æ˜ç¡®æµ‹è¯•è¦æ±‚ï¼š

```markdown
## 7. æµ‹è¯•ç”¨ä¾‹

### 7.1 å•å…ƒæµ‹è¯•
- **UserServiceæµ‹è¯•**
  - ç”¨æˆ·åˆ›å»ºæˆåŠŸæµ‹è¯•
  - ç”¨æˆ·åé‡å¤æµ‹è¯•
  - ç”¨æˆ·ä¿¡æ¯æ›´æ–°æµ‹è¯•
  - ç”¨æˆ·çŠ¶æ€å˜æ›´æµ‹è¯•
  
- **UserControlleræµ‹è¯•**
  - æ¥å£å‚æ•°éªŒè¯æµ‹è¯•
  - æƒé™éªŒè¯æµ‹è¯•
  - å¼‚å¸¸å¤„ç†æµ‹è¯•

### 7.2 é›†æˆæµ‹è¯•
- **ç”¨æˆ·æ³¨å†Œæµç¨‹æµ‹è¯•**
  - æ­£å¸¸æ³¨å†Œæµç¨‹
  - å¼‚å¸¸æƒ…å†µå¤„ç†
  - æ•°æ®ä¸€è‡´æ€§éªŒè¯

### 7.3 APIæµ‹è¯•
- **Postmanæµ‹è¯•é›†åˆ**
  - æ‰€æœ‰æ¥å£çš„è¯·æ±‚/å“åº”æµ‹è¯•
  - é”™è¯¯åœºæ™¯æµ‹è¯•
  - æ€§èƒ½æµ‹è¯•
```

### 6. éƒ¨ç½²é…ç½®éœ€è¦å…·ä½“åŒ–

**å½“å‰é—®é¢˜**: éƒ¨ç½²é…ç½®éƒ¨åˆ†ä¸ºç©º

**ä¼˜åŒ–å»ºè®®**: æ˜ç¡®éƒ¨ç½²è¦æ±‚ï¼š

```markdown
## 6. éƒ¨ç½²é…ç½®

### 6.1 åº”ç”¨é…ç½®
```yaml
# application-dev.yml
spring:
  profiles:
    active: dev
  datasource:
    url: jdbc:mysql://localhost:3306/banyu_mall_dev
  redis:
    host: localhost
    port: 6379
    database: 1

# application-prod.yml
spring:
  profiles:
    active: prod
  datasource:
    url: jdbc:mysql://prod-mysql:3306/banyu_mall
  redis:
    host: prod-redis
    port: 6379
    database: 1
```

### 6.2 ç½‘å…³è·¯ç”±é…ç½®
```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: user-service
          uri: lb://service-user
          predicates:
            - Path=/user/**
            - Path=/profile/**
            - Path=/config/**
          filters:
            - StripPrefix=0
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 10
                redis-rate-limiter.burstCapacity: 20
```

### 6.3 Dockeré…ç½®
```dockerfile
FROM openjdk:17-jdk-slim
COPY target/service-user.jar app.jar
EXPOSE 8082
ENTRYPOINT ["java", "-jar", "/app.jar"]
```
```

## ğŸš€ ä¼˜åŒ–åçš„å®Œæ•´æ¨¡æ¿ç»“æ„

```markdown
# [æ¨¡å—åç§°]è®¾è®¡æ–‡æ¡£

## 1. æ¨¡å—æ¦‚è¿°
[æ¨¡å—åŠŸèƒ½æè¿°ã€ä¸šåŠ¡ä»·å€¼ã€æ ¸å¿ƒèŒè´£]

## 2. æ•°æ®æ¨¡å‹è®¾è®¡
### 2.1 æ•°æ®åº“è¡¨ç»“æ„
[SQLæ–‡ä»¶å¼•ç”¨æˆ–è¡¨ç»“æ„è¯´æ˜]

### 2.2 å®ä½“ç±»è®¾è®¡
[è¯¦ç»†çš„å®ä½“ç±»ã€DTOç±»è®¾è®¡]

## 3. æ¥å£è®¾è®¡
### 3.1 [åŠŸèƒ½æ¨¡å—1]æ¥å£
#### 3.1.1 [æ¥å£åç§°]
- **æ¥å£è·¯å¾„**: `[HTTPæ–¹æ³•] [è·¯å¾„]`
- **è¯·æ±‚å¤´**: `[è¯·æ±‚å¤´è¦æ±‚]`
- **è¯·æ±‚å‚æ•°**: `[è¯¦ç»†çš„JSONæ ¼å¼å‚æ•°]`
- **å“åº”ç»“æœ**: `[è¯¦ç»†çš„JSONæ ¼å¼å“åº”]`
- **é”™è¯¯ç **: `[é”™è¯¯ç åˆ—è¡¨]`
- **ä¸šåŠ¡è§„åˆ™**: `[ä¸šåŠ¡é€»è¾‘è¦æ±‚]`

## 4. åŠŸèƒ½ç‰¹æ€§
### 4.1 [åŠŸèƒ½æ¨¡å—1]
- âœ… **[å…·ä½“åŠŸèƒ½1]**
  - [è¯¦ç»†å®ç°è¦æ±‚]
  - [ä¸šåŠ¡è§„åˆ™]
- âœ… **[å…·ä½“åŠŸèƒ½2]**
  - [è¯¦ç»†å®ç°è¦æ±‚]

## 5. æŠ€æœ¯å®ç°
### 5.1 æŠ€æœ¯æ ˆ
[å…·ä½“çš„æŠ€æœ¯é€‰å‹å’Œç‰ˆæœ¬]

### 5.2 æ ¸å¿ƒé…ç½®
[è¯¦ç»†çš„é…ç½®æ–‡ä»¶å†…å®¹]

### 5.3 ç¼“å­˜ç­–ç•¥
[ç¼“å­˜è®¾è®¡å’Œä½¿ç”¨ç­–ç•¥]

## 6. éƒ¨ç½²é…ç½®
### 6.1 åº”ç”¨é…ç½®
[ç¯å¢ƒé…ç½®æ–‡ä»¶]

### 6.2 ç½‘å…³è·¯ç”±é…ç½®
[ç½‘å…³è·¯ç”±è§„åˆ™]

### 6.3 Dockeré…ç½®
[å®¹å™¨åŒ–é…ç½®]

## 7. æµ‹è¯•ç”¨ä¾‹
### 7.1 å•å…ƒæµ‹è¯•
[å…·ä½“çš„æµ‹è¯•ç”¨ä¾‹è¦æ±‚]

### 7.2 é›†æˆæµ‹è¯•
[é›†æˆæµ‹è¯•è¦æ±‚]

### 7.3 APIæµ‹è¯•
[APIæµ‹è¯•è¦æ±‚]
```

## ğŸ“‹ æ€»ç»“

**å…³é”®ä¼˜åŒ–ç‚¹**:
1. **æ¥å£è®¾è®¡è¯¦ç»†åŒ–** - åŒ…å«å®Œæ•´çš„è¯·æ±‚/å“åº”æ ¼å¼ã€é”™è¯¯ç ã€ä¸šåŠ¡è§„åˆ™
2. **æ•°æ®æ¨¡å‹å…·ä½“åŒ–** - æ˜ç¡®çš„å®ä½“ç±»å’ŒDTOè®¾è®¡
3. **åŠŸèƒ½ç‰¹æ€§å…·ä½“åŒ–** - è¯¦ç»†çš„å®ç°è¦æ±‚å’Œä¸šåŠ¡è§„åˆ™
4. **æŠ€æœ¯å®ç°æ˜ç¡®åŒ–** - å…·ä½“çš„æŠ€æœ¯æ ˆã€é…ç½®ã€ç¼“å­˜ç­–ç•¥
5. **æµ‹è¯•ç”¨ä¾‹å…·ä½“åŒ–** - æ˜ç¡®çš„æµ‹è¯•è¦æ±‚å’Œè¦†ç›–èŒƒå›´
6. **éƒ¨ç½²é…ç½®å®Œæ•´åŒ–** - ç¯å¢ƒé…ç½®ã€ç½‘å…³é…ç½®ã€å®¹å™¨é…ç½®

**é¢„æœŸæ•ˆæœ**:
- å‡å°‘å¼€å‘è¿‡ç¨‹ä¸­çš„æ²Ÿé€šæˆæœ¬
- æé«˜ä»£ç ç”Ÿæˆçš„è´¨é‡å’Œå‡†ç¡®æ€§
- ç¡®ä¿å®ç°ä¸è®¾è®¡çš„ä¸€è‡´æ€§
- ä¾¿äºåç»­çš„ç»´æŠ¤å’Œæ‰©å±•

æ‚¨è§‰å¾—è¿™äº›ä¼˜åŒ–å»ºè®®å¦‚ä½•ï¼Ÿæˆ‘å¯ä»¥æ ¹æ®æ‚¨çš„åé¦ˆè¿›ä¸€æ­¥è°ƒæ•´æ¨¡æ¿ç»“æ„ã€‚ 