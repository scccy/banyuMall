# 项目操作规则

## 📋 规则概述

**ID**: DEV-001_PROJECT_OPERATION  
**Name**: 项目操作规则  
**Status**: Active  
**创建时间**: 2025-01-27  
**最后更新**: 2025-01-27  

## 🎯 规则目标

规范项目操作流程，确保开发环境的一致性和项目的可维护性。

## 📋 核心规则

### 1. 项目编译规则

#### 1.1 编译环境要求
- **Java版本**: 必须使用 Java 21
- **Maven版本**: 必须使用 Maven 3.8+
- **IDE**: 推荐使用 IntelliJ IDEA
- **操作系统**: 支持 macOS、Windows、Linux

#### 1.2 编译顺序
```
1. 根项目 (banyuMall)
   ↓
2. service-base (基础配置)
   ↓
3. service-common (通用工具)
   ↓
4. service模块 (service-auth, service-user, service-gateway)
   ↓
5. core模块 (core-publisher)
   ↓
6. third-party模块 (aliyun-oss)
```

#### 1.3 编译命令规范
```bash
# 完整编译（推荐）
mvn clean install -DskipTests

# 仅编译（快速验证）
mvn clean compile

# 编译并运行测试
mvn clean test

# 跳过测试编译
mvn clean compile test-compile -DskipTests
```

### 2. IDE操作规则

#### 2.1 IntelliJ IDEA配置
- **项目导入**: 必须导入根项目 `banyuMall`
- **Maven配置**: 使用项目内置的Maven配置
- **JDK配置**: 必须配置Java 21
- **编码设置**: 统一使用UTF-8编码

#### 2.2 项目刷新规则
- **依赖更新后**: 必须刷新Maven项目
- **配置变更后**: 必须重新导入项目
- **新增模块后**: 必须重新加载项目结构

#### 2.3 运行配置
- **开发环境**: 使用 `dev` profile
- **测试环境**: 使用 `test` profile
- **生产环境**: 使用 `prod` profile

### 3. 服务启动规则

#### 3.1 启动顺序
```
1. 基础设施服务
   - MySQL (3306)
   - Redis (6379)
   - Nacos (8848)

2. 基础服务
   - service-base (配置加载)
   - service-common (工具类加载)

3. 业务服务
   - service-auth (8081)
   - service-user (8082)
   - service-gateway (8080)

4. 核心服务
   - core-publisher (8083)

5. 第三方服务
   - aliyun-oss (8084)
```

#### 3.2 启动方式
- **开发环境**: 使用IDEA直接运行Application类
- **测试环境**: 使用Maven命令启动
- **生产环境**: 使用jar包启动

### 4. 测试规则

#### 4.1 测试环境配置
- **数据库**: 使用H2内存数据库
- **缓存**: 使用内存缓存
- **外部服务**: 使用Mock模拟

#### 4.2 测试执行
- **单元测试**: 在IDEA中直接运行
- **集成测试**: 使用Maven命令执行
- **性能测试**: 使用专门的测试工具

### 5. 依赖管理规则

#### 5.1 依赖更新
- **版本升级**: 必须先在测试环境验证
- **依赖冲突**: 必须及时解决
- **安全漏洞**: 必须及时修复

#### 5.2 依赖检查
```bash
# 检查依赖树
mvn dependency:tree

# 检查依赖冲突
mvn dependency:analyze

# 检查安全漏洞
mvn dependency:check
```

### 6. 代码提交规则

#### 6.1 提交前检查
- **编译检查**: 确保项目能够正常编译
- **测试检查**: 确保所有测试通过
- **代码规范**: 确保符合代码规范

#### 6.2 提交信息规范
```
[模块名] 简短描述

详细描述（可选）

相关任务: #任务ID
```

### 7. 环境管理规则

#### 7.1 环境配置
- **开发环境**: 使用本地配置
- **测试环境**: 使用测试配置
- **生产环境**: 使用生产配置

#### 7.2 配置文件管理
- **敏感信息**: 不得提交到版本控制
- **环境变量**: 使用环境变量管理敏感信息
- **配置分离**: 不同环境的配置必须分离

## 🚫 禁止事项

### 1. 编译相关
- **禁止**: 在命令行中直接运行编译命令（AI助手）
- **禁止**: 使用不兼容的Java版本
- **禁止**: 跳过必要的编译步骤

### 2. 运行相关
- **禁止**: 同时启动多个相同端口的服务
- **禁止**: 在生产环境使用开发配置
- **禁止**: 在开发环境使用生产配置

### 3. 依赖相关
- **禁止**: 引入不必要的依赖
- **禁止**: 使用不稳定的依赖版本
- **禁止**: 忽略依赖冲突警告

## ✅ 推荐做法

### 1. 开发流程
1. **拉取最新代码**
2. **刷新Maven项目**
3. **检查依赖状态**
4. **编译项目**
5. **运行测试**
6. **启动服务**
7. **验证功能**

### 2. 问题排查
1. **检查Java版本**
2. **检查Maven配置**
3. **检查依赖状态**
4. **检查配置文件**
5. **检查端口占用**
6. **查看日志信息**

### 3. 性能优化
1. **使用IDEA的懒加载功能**
2. **合理配置JVM参数**
3. **使用增量编译**
4. **合理使用缓存**

## 📝 注意事项

1. **AI助手限制**: AI助手不得执行编译和运行命令，用户应在IDEA中操作
2. **环境一致性**: 确保开发、测试、生产环境的一致性
3. **文档同步**: 及时更新相关文档
4. **版本管理**: 合理管理项目版本和依赖版本

## 🔄 规则更新

- **更新频率**: 根据项目发展需要及时更新
- **更新流程**: 通过任务状态文件记录更新过程
- **版本控制**: 规则变更必须记录在版本控制中

---

**维护者**: scccy  
**审核者**: 项目团队  
**生效时间**: 2025-01-27 