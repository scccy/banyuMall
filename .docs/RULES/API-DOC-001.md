# API文档维护规则

**ID**: API-DOC-001  
**Name**: API文档维护规则  
**Status**: Active  
**创建时间**: 2025-01-27  

## 触发情景 (Context/Trigger)
当项目中有新的API接口开发、修改或删除时，必须更新API文档。

## 指令 (Directive)

### 1. 文档结构规范
- **必须 (MUST)** 按照服务模块分组组织接口
- **必须 (MUST)** 每个接口包含以下信息：
  - 接口路径
  - HTTP方法
  - 所属服务
  - 接口类型（Controller/Feign Client）
  - 微服务端口
  - 网关路径
  - 认证要求
  - 请求参数（路径参数、查询参数、请求体）
  - 响应数据格式
  - 错误响应示例

### 2. 接口信息完整性
- **必须 (MUST)** 提供完整的请求参数说明
- **必须 (MUST)** 提供完整的响应数据格式
- **必须 (MUST)** 说明认证要求（是否需要token）
- **必须 (MUST)** 提供错误码和错误信息
- **必须 (MUST)** 提供接口调用示例

### 3. 文档更新时机
- **必须 (MUST)** 新增接口时立即更新API.md
- **必须 (MUST)** 修改接口时立即更新API.md
- **必须 (MUST)** 删除接口时立即更新API.md
- **必须 (MUST)** 版本更新时更新文档版本号

### 4. 文档格式规范
- **必须 (MUST)** 使用Markdown格式
- **必须 (MUST)** 使用统一的JSON格式示例
- **必须 (MUST)** 使用表格展示路由配置
- **必须 (MUST)** 使用代码块展示请求响应示例

### 5. 服务路由信息
- **必须 (MUST)** 记录每个服务的端口号
- **必须 (MUST)** 记录网关路由规则
- **必须 (MUST)** 区分Controller接口和Feign Client接口
- **必须 (MUST)** 说明服务间调用的关系

### 6. 错误处理规范
- **必须 (MUST)** 定义通用错误码
- **必须 (MUST)** 定义业务错误码
- **必须 (MUST)** 提供错误码说明和解决方案
- **必须 (MUST)** 提供错误响应示例

### 7. 开发环境配置
- **必须 (MUST)** 提供本地开发环境启动命令
- **必须 (MUST)** 记录服务端口配置
- **必须 (MUST)** 记录数据库配置信息
- **必须 (MUST)** 提供接口测试示例

## 理由 (Justification)
此规则源于任务 `task_20250127_1430_api_documentation.md`。在该任务中，需要为半语积分商城项目创建完整的API文档，确保开发团队和前端团队能够准确理解和使用所有接口。

## 文档模板

### 接口文档模板
```markdown
##### 接口名称
- **接口路径**: `/path/to/interface`
- **HTTP方法**: `GET/POST/PUT/DELETE`
- **所属服务**: service-name
- **接口类型**: Controller/Feign Client
- **微服务端口**: 808x
- **网关路径**: `/gateway/path`
- **认证要求**: 需要Bearer Token

**路径参数**:
- `paramName`: 参数说明 (必填/可选)

**查询参数**:
- `paramName`: 参数说明 (必填/可选)

**请求参数**:
```json
{
  "fieldName": "string"  // 字段说明
}
```

**响应数据**:
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "fieldName": "string"  // 字段说明
  }
}
```
```

### 错误码模板
```markdown
| 错误码 | 说明 | 解决方案 |
|--------|------|----------|
| 200 | 成功 | - |
| 400 | 请求参数错误 | 检查请求参数格式和必填项 |
```

## 检查清单
- [ ] 接口路径正确
- [ ] HTTP方法正确
- [ ] 所属服务信息完整
- [ ] 请求参数说明完整
- [ ] 响应数据格式正确
- [ ] 错误码定义完整
- [ ] 调用示例提供
- [ ] 认证要求说明
- [ ] 文档版本更新
- [ ] readme.md中引用更新 